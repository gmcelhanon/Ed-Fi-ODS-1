BEGIN
    DECLARE @schoolYearContext AS INT = 2019

    -- disable all constraints
    EXEC sp_MSforeachtable "ALTER TABLE ? NOCHECK CONSTRAINT all"

        MERGE edfi.AbsenceEventCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AbsenceEventCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AbsenceEventCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AbsenceEventCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AcademicHonorCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AcademicHonorCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AcademicHonorCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AcademicHonorCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AcademicSubjectDescriptor AS target
        USING EdFi_Ods_2021.edfi.AcademicSubjectDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AcademicSubjectDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AcademicSubjectDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AcademicWeek AS target
        USING EdFi_Ods_2021.edfi.AcademicWeek AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolId)
        + '|' +     source.WeekIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.TotalInstructionalDays = source.TotalInstructionalDays
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolId
                , WeekIdentifier
                -- Identifying references
                , SchoolHashKey
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     source.WeekIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolId
                , WeekIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AccommodationDescriptor AS target
        USING EdFi_Ods_2021.edfi.AccommodationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AccommodationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccommodationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccommodationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccommodationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccommodationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Account AS target
        USING EdFi_Ods_2021.edfi.Account AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AccountName = source.AccountName
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , AccountName
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , AccountName
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AccountAccountCode AS target
        USING EdFi_Ods_2021.edfi.AccountAccountCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AccountClassificationDescriptorId)
        + '|' +     source.AccountCodeNumber
        + '|' +     source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AccountCodeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AccountClassificationDescriptorId)
            + '|' +     source.AccountCodeNumber
            + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AccountCodeHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                + '|' +     source.AccountCodeNumber
                + '|' +     source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                + '|' +     source.AccountCodeNumber
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AccountabilityRating AS target
        USING EdFi_Ods_2021.edfi.AccountabilityRating AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.RatingTitle
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Rating = source.Rating
            , target.RatingDate = source.RatingDate
            , target.RatingOrganization = source.RatingOrganization
            , target.RatingProgram = source.RatingProgram
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , RatingTitle
                , SchoolYear
                -- Identifying references
                , EducationOrganizationHashKey
                , SchoolYearTypeHashKey
                -- Attributes
                , Rating
                , RatingDate
                , RatingOrganization
                , RatingProgram
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.RatingTitle
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , RatingTitle
                , SchoolYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Attributes
                , Rating
                , RatingDate
                , RatingOrganization
                , RatingProgram
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AccountClassificationDescriptor AS target
        USING EdFi_Ods_2021.edfi.AccountClassificationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AccountClassificationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountClassificationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountClassificationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AccountCode AS target
        USING EdFi_Ods_2021.edfi.AccountCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AccountClassificationDescriptorId)
        + '|' +     source.AccountCodeNumber
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AccountCodeDescription = source.AccountCodeDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountClassificationDescriptorId
                , AccountCodeNumber
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , AccountClassificationDescriptorHashKey
                , EducationOrganizationHashKey
                -- Attributes
                , AccountCodeDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                + '|' +     source.AccountCodeNumber
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountClassificationDescriptorId
                , AccountCodeNumber
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccountClassificationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , AccountCodeDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AchievementCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AchievementCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AchievementCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AchievementCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Actual AS target
        USING EdFi_Ods_2021.edfi.Actual AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AmountToDate = source.AmountToDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , AccountHashKey
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AdditionalCreditTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.AdditionalCreditTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AdditionalCreditTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AdditionalCreditTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AddressTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.AddressTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AddressTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AddressTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AdministrationEnvironmentDescriptor AS target
        USING EdFi_Ods_2021.edfi.AdministrationEnvironmentDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AdministrationEnvironmentDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AdministrationEnvironmentDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationEnvironmentDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AdministrationEnvironmentDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationEnvironmentDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AdministrativeFundingControlDescriptor AS target
        USING EdFi_Ods_2021.edfi.AdministrativeFundingControlDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AdministrativeFundingControlDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AdministrativeFundingControlDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Assessment AS target
        USING EdFi_Ods_2021.edfi.Assessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AdaptiveAssessment = source.AdaptiveAssessment
            , target.AssessmentFamily = source.AssessmentFamily
            , target.AssessmentForm = source.AssessmentForm
            , target.AssessmentTitle = source.AssessmentTitle
            , target.AssessmentVersion = source.AssessmentVersion
            , target.MaxRawScore = source.MaxRawScore
            , target.Nomenclature = source.Nomenclature
            , target.RevisionDate = source.RevisionDate
                -- References
            , target.AssessmentCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentCategoryDescriptorId)
                )
            , target.EducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , Namespace
                -- Identifying references
                -- Attributes
                , AdaptiveAssessment
                , AssessmentFamily
                , AssessmentForm
                , AssessmentTitle
                , AssessmentVersion
                , MaxRawScore
                , Nomenclature
                , RevisionDate
                -- References
                , AssessmentCategoryDescriptorHashKey
                , EducationOrganizationHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , Namespace
                -- Identifying references
                -- Attributes
                , AdaptiveAssessment
                , AssessmentFamily
                , AssessmentForm
                , AssessmentTitle
                , AssessmentVersion
                , MaxRawScore
                , Nomenclature
                , RevisionDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AssessmentAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.AssessmentAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentAssessedGradeLevel AS target
        USING EdFi_Ods_2021.edfi.AssessmentAssessedGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentContentStandard AS target
        USING EdFi_Ods_2021.edfi.AssessmentContentStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.PublicationDate = source.PublicationDate
            , target.PublicationYear = source.PublicationYear
            , target.Title = source.Title
            , target.URI = source.URI
            , target.Version = source.Version
                -- References
            , target.MandatingEducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
            , target.PublicationStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , MandatingEducationOrganizationHashKey
                , PublicationStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentContentStandardAuthor AS target
        USING EdFi_Ods_2021.edfi.AssessmentContentStandardAuthor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.Author = source.Author
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.AssessmentIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
        + '|' +     source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentIdentificationSystemDescriptorHashKey
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
                + '|' +     source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
                )
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentLanguage AS target
        USING EdFi_Ods_2021.edfi.AssessmentLanguage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentPerformanceLevel AS target
        USING EdFi_Ods_2021.edfi.AssessmentPerformanceLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
            AND target.PerformanceLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                , PerformanceLevelDescriptorHashKey
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentPeriod AS target
        USING EdFi_Ods_2021.edfi.AssessmentPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
                -- References
            , target.AssessmentPeriodDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentPeriodDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                -- References
                , AssessmentPeriodDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentPeriodDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentPlatformType AS target
        USING EdFi_Ods_2021.edfi.AssessmentPlatformType AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.PlatformTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.PlatformTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PlatformTypeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , PlatformTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentProgram AS target
        USING EdFi_Ods_2021.edfi.AssessmentProgram AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Namespace
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Namespace
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentScore AS target
        USING EdFi_Ods_2021.edfi.AssessmentScore AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentSection AS target
        USING EdFi_Ods_2021.edfi.AssessmentSection AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.LocalCourseCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SectionHashKey = HASHBYTES('sha1',
                source.LocalCourseCode
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            + '|' +     source.SectionIdentifier
            + '|' +     source.SessionName
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SectionHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.LocalCourseCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AssessmentIdentificationSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentIdentificationSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentIdentificationSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentIdentificationSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentIdentificationSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AssessmentItem AS target
        USING EdFi_Ods_2021.edfi.AssessmentItem AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AssessmentItemURI = source.AssessmentItemURI
            , target.CorrectResponse = source.CorrectResponse
            , target.ExpectedTimeAssessed = source.ExpectedTimeAssessed
            , target.ItemText = source.ItemText
            , target.MaxRawScore = source.MaxRawScore
            , target.Nomenclature = source.Nomenclature
                -- References
            , target.AssessmentItemCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemCategoryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , IdentificationCode
                , Namespace
                -- Identifying references
                , AssessmentHashKey
                -- Attributes
                , AssessmentItemURI
                , CorrectResponse
                , ExpectedTimeAssessed
                , ItemText
                , MaxRawScore
                , Nomenclature
                -- References
                , AssessmentItemCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , IdentificationCode
                , Namespace
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                -- Attributes
                , AssessmentItemURI
                , CorrectResponse
                , ExpectedTimeAssessed
                , ItemText
                , MaxRawScore
                , Nomenclature
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.AssessmentItemLearningStandard AS target
        USING EdFi_Ods_2021.edfi.AssessmentItemLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.LearningStandardId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.LearningStandardId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentItemPossibleResponse AS target
        USING EdFi_Ods_2021.edfi.AssessmentItemPossibleResponse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.ResponseValue = source.ResponseValue
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CorrectResponse = source.CorrectResponse
            , target.ResponseDescription = source.ResponseDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , ResponseValue
                -- Attributes
                , CorrectResponse
                , ResponseDescription
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , ResponseValue
                -- Attributes
                , CorrectResponse
                , ResponseDescription
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.AssessmentItemCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentItemCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentItemCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentItemCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentItemCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AssessmentItemResultDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentItemResultDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentItemResultDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentItemResultDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemResultDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentItemResultDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemResultDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AssessmentPeriodDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentPeriodDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentPeriodDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentPeriodDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentPeriodDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentPeriodDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentPeriodDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AssessmentReportingMethodDescriptor AS target
        USING EdFi_Ods_2021.edfi.AssessmentReportingMethodDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentReportingMethodDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentReportingMethodDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AttemptStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.AttemptStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttemptStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttemptStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttemptStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.AttendanceEventCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.AttendanceEventCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.BehaviorDescriptor AS target
        USING EdFi_Ods_2021.edfi.BehaviorDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BehaviorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BehaviorDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , BehaviorDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.BellSchedule AS target
        USING EdFi_Ods_2021.edfi.BellSchedule AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.BellScheduleName
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AlternateDayName = source.AlternateDayName
            , target.EndTime = source.EndTime
            , target.StartTime = source.StartTime
            , target.TotalInstructionalTime = source.TotalInstructionalTime
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BellScheduleName
                , SchoolId
                -- Identifying references
                , SchoolHashKey
                -- Attributes
                , AlternateDayName
                , EndTime
                , StartTime
                , TotalInstructionalTime
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.BellScheduleName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , BellScheduleName
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , AlternateDayName
                , EndTime
                , StartTime
                , TotalInstructionalTime
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.BellScheduleClassPeriod AS target
        USING EdFi_Ods_2021.edfi.BellScheduleClassPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.BellScheduleName
        + '|' +     source.ClassPeriodName
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ClassPeriodHashKey = HASHBYTES('sha1',
                source.ClassPeriodName
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ClassPeriodHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.BellScheduleName
                + '|' +     source.ClassPeriodName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.ClassPeriodName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.BellScheduleDate AS target
        USING EdFi_Ods_2021.edfi.BellScheduleDate AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.BellScheduleName
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.Date = source.Date
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Date
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.BellScheduleName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Date
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.BellScheduleGradeLevel AS target
        USING EdFi_Ods_2021.edfi.BellScheduleGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.BellScheduleName
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.BellScheduleName
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.Budget AS target
        USING EdFi_Ods_2021.edfi.Budget AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Amount = source.Amount
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , AccountHashKey
                -- Attributes
                , Amount
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                -- Attributes
                , Amount
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.Calendar AS target
        USING EdFi_Ods_2021.edfi.Calendar AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CalendarCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
                -- References
            , target.CalendarTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CalendarCode
                , SchoolId
                , SchoolYear
                -- Identifying references
                , SchoolHashKey
                , SchoolYearTypeHashKey
                -- References
                , CalendarTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , CalendarCode
                , SchoolId
                , SchoolYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CalendarGradeLevel AS target
        USING EdFi_Ods_2021.edfi.CalendarGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CalendarCode
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CalendarDate AS target
        USING EdFi_Ods_2021.edfi.CalendarDate AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CalendarCode
        + '|' +     CONVERT(nvarchar, source.Date, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CalendarCode
                , Date
                , SchoolId
                , SchoolYear
                -- Identifying references
                , CalendarHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.Date, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , CalendarCode
                , Date
                , SchoolId
                , SchoolYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CalendarDateCalendarEvent AS target
        USING EdFi_Ods_2021.edfi.CalendarDateCalendarEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CalendarCode
        + '|' +     CONVERT(nvarchar, source.CalendarEventDescriptorId)
        + '|' +     CONVERT(nvarchar, source.Date, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CalendarEventDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CalendarEventDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CalendarEventDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.CalendarEventDescriptorId)
                + '|' +     CONVERT(nvarchar, source.Date, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarEventDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CalendarEventDescriptor AS target
        USING EdFi_Ods_2021.edfi.CalendarEventDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CalendarEventDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CalendarEventDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarEventDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CalendarEventDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarEventDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CalendarTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CalendarTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CalendarTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CalendarTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CalendarTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CalendarTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CareerPathwayDescriptor AS target
        USING EdFi_Ods_2021.edfi.CareerPathwayDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CareerPathwayDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CareerPathwayDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CareerPathwayDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CharterApprovalAgencyTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CharterApprovalAgencyTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CharterApprovalAgencyTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CharterApprovalAgencyTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalAgencyTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CharterApprovalAgencyTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalAgencyTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CharterStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.CharterStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CharterStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CharterStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CharterStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CitizenshipStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.CitizenshipStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CitizenshipStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CitizenshipStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ClassPeriod AS target
        USING EdFi_Ods_2021.edfi.ClassPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ClassPeriodName
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.OfficialAttendancePeriod = source.OfficialAttendancePeriod
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ClassPeriodName
                , SchoolId
                -- Identifying references
                , SchoolHashKey
                -- Attributes
                , OfficialAttendancePeriod
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ClassPeriodName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ClassPeriodName
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , OfficialAttendancePeriod
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ClassPeriodMeetingTime AS target
        USING EdFi_Ods_2021.edfi.ClassPeriodMeetingTime AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ClassPeriodName
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.EndTime = source.EndTime
            AND target.StartTime = source.StartTime
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , EndTime
                , StartTime
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ClassPeriodName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , EndTime
                , StartTime
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ClassroomPositionDescriptor AS target
        USING EdFi_Ods_2021.edfi.ClassroomPositionDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ClassroomPositionDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ClassroomPositionDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassroomPositionDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ClassroomPositionDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassroomPositionDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Cohort AS target
        USING EdFi_Ods_2021.edfi.Cohort AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CohortIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CohortDescription = source.CohortDescription
                -- References
            , target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
            , target.CohortScopeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortScopeDescriptorId)
                )
            , target.CohortTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CohortIdentifier
                , EducationOrganizationId
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , CohortDescription
                -- References
                , AcademicSubjectDescriptorHashKey
                , CohortScopeDescriptorHashKey
                , CohortTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CohortIdentifier
                , EducationOrganizationId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , CohortDescription
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortScopeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CohortProgram AS target
        USING EdFi_Ods_2021.edfi.CohortProgram AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CohortIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ProgramEducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CohortScopeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CohortScopeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CohortScopeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CohortScopeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortScopeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CohortScopeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortScopeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CohortTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CohortTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CohortTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CohortTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CohortTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CohortYearTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CohortYearTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CohortYearTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CohortYearTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CommunityOrganization AS target
        USING EdFi_Ods_2021.edfi.CommunityOrganization AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CommunityOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CommunityOrganizationId
                -- Identifying references
                , EducationOrganizationHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CommunityOrganizationId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityOrganizationId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CommunityProvider AS target
        USING EdFi_Ods_2021.edfi.CommunityProvider AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CommunityProviderId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.LicenseExemptIndicator = source.LicenseExemptIndicator
            , target.SchoolIndicator = source.SchoolIndicator
                -- References
            , target.CommunityOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityOrganizationId)
                )
            , target.ProviderCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderCategoryDescriptorId)
                )
            , target.ProviderProfitabilityDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderProfitabilityDescriptorId)
                )
            , target.ProviderStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CommunityProviderId
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , LicenseExemptIndicator
                , SchoolIndicator
                -- References
                , CommunityOrganizationHashKey
                , ProviderCategoryDescriptorHashKey
                , ProviderProfitabilityDescriptorHashKey
                , ProviderStatusDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityProviderId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CommunityProviderId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityProviderId)
                )
                -- Attributes
                , LicenseExemptIndicator
                , SchoolIndicator
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderProfitabilityDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CommunityProviderLicense AS target
        USING EdFi_Ods_2021.edfi.CommunityProviderLicense AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CommunityProviderId)
        + '|' +     source.LicenseIdentifier
        + '|' +     source.LicensingOrganization
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AuthorizedFacilityCapacity = source.AuthorizedFacilityCapacity
            , target.LicenseEffectiveDate = source.LicenseEffectiveDate
            , target.LicenseExpirationDate = source.LicenseExpirationDate
            , target.LicenseIssueDate = source.LicenseIssueDate
            , target.OldestAgeAuthorizedToServe = source.OldestAgeAuthorizedToServe
            , target.YoungestAgeAuthorizedToServe = source.YoungestAgeAuthorizedToServe
                -- References
            , target.LicenseStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseStatusDescriptorId)
                )
            , target.LicenseTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CommunityProviderId
                , LicenseIdentifier
                , LicensingOrganization
                -- Identifying references
                , CommunityProviderHashKey
                -- Attributes
                , AuthorizedFacilityCapacity
                , LicenseEffectiveDate
                , LicenseExpirationDate
                , LicenseIssueDate
                , OldestAgeAuthorizedToServe
                , YoungestAgeAuthorizedToServe
                -- References
                , LicenseStatusDescriptorHashKey
                , LicenseTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityProviderId)
                + '|' +     source.LicenseIdentifier
                + '|' +     source.LicensingOrganization
                )
                , @schoolYearContext
                -- Primary key columns
                , CommunityProviderId
                , LicenseIdentifier
                , LicensingOrganization
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CommunityProviderId)
                )
                -- Attributes
                , AuthorizedFacilityCapacity
                , LicenseEffectiveDate
                , LicenseExpirationDate
                , LicenseIssueDate
                , OldestAgeAuthorizedToServe
                , YoungestAgeAuthorizedToServe
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CompetencyLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.CompetencyLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CompetencyLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CompetencyLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CompetencyObjective AS target
        USING EdFi_Ods_2021.edfi.CompetencyObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Objective
        + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CompetencyObjectiveId = source.CompetencyObjectiveId
            , target.Description = source.Description
            , target.SuccessCriteria = source.SuccessCriteria
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Objective
                , ObjectiveGradeLevelDescriptorId
                -- Identifying references
                , EducationOrganizationHashKey
                , ObjectiveGradeLevelDescriptorHashKey
                -- Attributes
                , CompetencyObjectiveId
                , Description
                , SuccessCriteria
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Objective
                , ObjectiveGradeLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                )
                -- Attributes
                , CompetencyObjectiveId
                , Description
                , SuccessCriteria
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ContactTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.ContactTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ContactTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ContactTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContactTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ContactTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContactTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ContentClassDescriptor AS target
        USING EdFi_Ods_2021.edfi.ContentClassDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ContentClassDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ContentClassDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContentClassDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ContentClassDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContentClassDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ContinuationOfServicesReasonDescriptor AS target
        USING EdFi_Ods_2021.edfi.ContinuationOfServicesReasonDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ContinuationOfServicesReasonDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ContinuationOfServicesReasonDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContinuationOfServicesReasonDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ContinuationOfServicesReasonDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContinuationOfServicesReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ContractedStaff AS target
        USING EdFi_Ods_2021.edfi.ContractedStaff AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AmountToDate = source.AmountToDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                , StaffUSI
                -- Identifying references
                , AccountHashKey
                , StaffHashKey
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CostRateDescriptor AS target
        USING EdFi_Ods_2021.edfi.CostRateDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CostRateDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CostRateDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CostRateDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CostRateDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CostRateDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CountryDescriptor AS target
        USING EdFi_Ods_2021.edfi.CountryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CountryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CountryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CountryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Course AS target
        USING EdFi_Ods_2021.edfi.Course AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CourseDescription = source.CourseDescription
            , target.CourseTitle = source.CourseTitle
            , target.DateCourseAdopted = source.DateCourseAdopted
            , target.HighSchoolCourseRequirement = source.HighSchoolCourseRequirement
            , target.MaxCompletionsForCredit = source.MaxCompletionsForCredit
            , target.MaximumAvailableCreditConversion = source.MaximumAvailableCreditConversion
            , target.MaximumAvailableCredits = source.MaximumAvailableCredits
            , target.MinimumAvailableCreditConversion = source.MinimumAvailableCreditConversion
            , target.MinimumAvailableCredits = source.MinimumAvailableCredits
            , target.NumberOfParts = source.NumberOfParts
            , target.TimeRequiredForCompletion = source.TimeRequiredForCompletion
                -- References
            , target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
            , target.CareerPathwayDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                )
            , target.CourseDefinedByDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseDefinedByDescriptorId)
                )
            , target.CourseGPAApplicabilityDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseGPAApplicabilityDescriptorId)
                )
            , target.MinimumAvailableCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MinimumAvailableCreditTypeDescriptorId)
                )
            , target.MaximumAvailableCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MaximumAvailableCreditTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseCode
                , EducationOrganizationId
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , CourseDescription
                , CourseTitle
                , DateCourseAdopted
                , HighSchoolCourseRequirement
                , MaxCompletionsForCredit
                , MaximumAvailableCreditConversion
                , MaximumAvailableCredits
                , MinimumAvailableCreditConversion
                , MinimumAvailableCredits
                , NumberOfParts
                , TimeRequiredForCompletion
                -- References
                , AcademicSubjectDescriptorHashKey
                , CareerPathwayDescriptorHashKey
                , CourseDefinedByDescriptorHashKey
                , CourseGPAApplicabilityDescriptorHashKey
                , MinimumAvailableCreditTypeDescriptorHashKey
                , MaximumAvailableCreditTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseCode
                , EducationOrganizationId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , CourseDescription
                , CourseTitle
                , DateCourseAdopted
                , HighSchoolCourseRequirement
                , MaxCompletionsForCredit
                , MaximumAvailableCreditConversion
                , MaximumAvailableCredits
                , MinimumAvailableCreditConversion
                , MinimumAvailableCredits
                , NumberOfParts
                , TimeRequiredForCompletion
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseDefinedByDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseGPAApplicabilityDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MinimumAvailableCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MaximumAvailableCreditTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CourseCompetencyLevel AS target
        USING EdFi_Ods_2021.edfi.CourseCompetencyLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CompetencyLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CompetencyLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.CourseIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
            , target.CourseCatalogURL = source.CourseCatalogURL
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseIdentificationSystemDescriptorHashKey
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , CourseCatalogURL
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                )
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , CourseCatalogURL
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseLearningObjective AS target
        USING EdFi_Ods_2021.edfi.CourseLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningObjectiveHashKey = HASHBYTES('sha1',
                source.LearningObjectiveId
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseLearningStandard AS target
        USING EdFi_Ods_2021.edfi.CourseLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseLevelCharacteristic AS target
        USING EdFi_Ods_2021.edfi.CourseLevelCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseLevelCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseLevelCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseOfferedGradeLevel AS target
        USING EdFi_Ods_2021.edfi.CourseOfferedGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseAttemptResultDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseAttemptResultDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseAttemptResultDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseAttemptResultDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseDefinedByDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseDefinedByDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseDefinedByDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseDefinedByDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseDefinedByDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseDefinedByDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseDefinedByDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseGPAApplicabilityDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseGPAApplicabilityDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseGPAApplicabilityDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseGPAApplicabilityDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseGPAApplicabilityDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseGPAApplicabilityDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseGPAApplicabilityDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseIdentificationSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseIdentificationSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseIdentificationSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseIdentificationSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseLevelCharacteristicDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseLevelCharacteristicDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseLevelCharacteristicDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseLevelCharacteristicDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseOffering AS target
        USING EdFi_Ods_2021.edfi.CourseOffering AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.InstructionalTimePlanned = source.InstructionalTimePlanned
            , target.LocalCourseTitle = source.LocalCourseTitle
                -- References
            , target.CourseHashKey = HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SessionName
                -- Identifying references
                , SchoolHashKey
                , SessionHashKey
                -- Attributes
                , InstructionalTimePlanned
                , LocalCourseTitle
                -- References
                , CourseHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SessionName
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                -- Attributes
                , InstructionalTimePlanned
                , LocalCourseTitle
                -- References
                , HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CourseOfferingCourseLevelCharacteristic AS target
        USING EdFi_Ods_2021.edfi.CourseOfferingCourseLevelCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseLevelCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseLevelCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseOfferingCurriculumUsed AS target
        USING EdFi_Ods_2021.edfi.CourseOfferingCurriculumUsed AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CurriculumUsedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CurriculumUsedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseOfferingOfferedGradeLevel AS target
        USING EdFi_Ods_2021.edfi.CourseOfferingOfferedGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseRepeatCodeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CourseRepeatCodeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseRepeatCodeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseRepeatCodeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseRepeatCodeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseRepeatCodeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseRepeatCodeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CourseTranscript AS target
        USING EdFi_Ods_2021.edfi.CourseTranscript AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AlternativeCourseCode = source.AlternativeCourseCode
            , target.AlternativeCourseTitle = source.AlternativeCourseTitle
            , target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
            , target.AttemptedCreditConversion = source.AttemptedCreditConversion
            , target.AttemptedCredits = source.AttemptedCredits
            , target.CourseCatalogURL = source.CourseCatalogURL
            , target.CourseTitle = source.CourseTitle
            , target.EarnedCreditConversion = source.EarnedCreditConversion
            , target.EarnedCredits = source.EarnedCredits
            , target.FinalLetterGradeEarned = source.FinalLetterGradeEarned
            , target.FinalNumericGradeEarned = source.FinalNumericGradeEarned
                -- References
            , target.CourseRepeatCodeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseRepeatCodeDescriptorId)
                )
            , target.AttemptedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptedCreditTypeDescriptorId)
                )
            , target.EarnedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EarnedCreditTypeDescriptorId)
                )
            , target.ExternalEducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExternalEducationOrganizationId)
                )
            , target.WhenTakenGradeLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenTakenGradeLevelDescriptorId)
                )
            , target.MethodCreditEarnedDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MethodCreditEarnedDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseAttemptResultDescriptorId
                , CourseCode
                , CourseEducationOrganizationId
                , EducationOrganizationId
                , SchoolYear
                , StudentUSI
                , TermDescriptorId
                -- Identifying references
                , CourseHashKey
                , CourseAttemptResultDescriptorHashKey
                , StudentAcademicRecordHashKey
                -- Attributes
                , AlternativeCourseCode
                , AlternativeCourseTitle
                , AssigningOrganizationIdentificationCode
                , AttemptedCreditConversion
                , AttemptedCredits
                , CourseCatalogURL
                , CourseTitle
                , EarnedCreditConversion
                , EarnedCredits
                , FinalLetterGradeEarned
                , FinalNumericGradeEarned
                -- References
                , CourseRepeatCodeDescriptorHashKey
                , AttemptedCreditTypeDescriptorHashKey
                , EarnedCreditTypeDescriptorHashKey
                , ExternalEducationOrganizationHashKey
                , WhenTakenGradeLevelDescriptorHashKey
                , MethodCreditEarnedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseAttemptResultDescriptorId
                , CourseCode
                , CourseEducationOrganizationId
                , EducationOrganizationId
                , SchoolYear
                , StudentUSI
                , TermDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                -- Attributes
                , AlternativeCourseCode
                , AlternativeCourseTitle
                , AssigningOrganizationIdentificationCode
                , AttemptedCreditConversion
                , AttemptedCredits
                , CourseCatalogURL
                , CourseTitle
                , EarnedCreditConversion
                , EarnedCredits
                , FinalLetterGradeEarned
                , FinalNumericGradeEarned
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseRepeatCodeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptedCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EarnedCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExternalEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenTakenGradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MethodCreditEarnedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CourseTranscriptAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.CourseTranscriptAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseTranscriptAlternativeCourseIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.CourseTranscriptAlternativeCourseIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
            , target.CourseCatalogURL = source.CourseCatalogURL
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseIdentificationSystemDescriptorHashKey
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , CourseCatalogURL
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseIdentificationSystemDescriptorId)
                )
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , CourseCatalogURL
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseTranscriptCreditCategory AS target
        USING EdFi_Ods_2021.edfi.CourseTranscriptCreditCategory AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.CreditCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CreditCategoryDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CreditCategoryDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CreditCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CourseTranscriptEarnedAdditionalCredits AS target
        USING EdFi_Ods_2021.edfi.CourseTranscriptEarnedAdditionalCredits AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
        + '|' +     source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AdditionalCreditTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.Credits = source.Credits
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AdditionalCreditTypeDescriptorHashKey
                -- Attributes
                , Credits
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.CourseAttemptResultDescriptorId)
                + '|' +     source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdditionalCreditTypeDescriptorId)
                )
                -- Attributes
                , Credits
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.Credential AS target
        USING EdFi_Ods_2021.edfi.Credential AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CredentialIdentifier
        + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EffectiveDate = source.EffectiveDate
            , target.ExpirationDate = source.ExpirationDate
            , target.IssuanceDate = source.IssuanceDate
            , target.Namespace = source.Namespace
                -- References
            , target.CredentialFieldDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialFieldDescriptorId)
                )
            , target.CredentialTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialTypeDescriptorId)
                )
            , target.TeachingCredentialBasisDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialBasisDescriptorId)
                )
            , target.TeachingCredentialDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CredentialIdentifier
                , StateOfIssueStateAbbreviationDescriptorId
                -- Identifying references
                , StateOfIssueStateAbbreviationDescriptorHashKey
                -- Attributes
                , EffectiveDate
                , ExpirationDate
                , IssuanceDate
                , Namespace
                -- References
                , CredentialFieldDescriptorHashKey
                , CredentialTypeDescriptorHashKey
                , TeachingCredentialBasisDescriptorHashKey
                , TeachingCredentialDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CredentialIdentifier
                , StateOfIssueStateAbbreviationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                -- Attributes
                , EffectiveDate
                , ExpirationDate
                , IssuanceDate
                , Namespace
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialFieldDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialBasisDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.CredentialAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.CredentialAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     source.CredentialIdentifier
        + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CredentialEndorsement AS target
        USING EdFi_Ods_2021.edfi.CredentialEndorsement AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CredentialIdentifier
        + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.CredentialEndorsement = source.CredentialEndorsement
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , CredentialEndorsement
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , CredentialEndorsement
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CredentialGradeLevel AS target
        USING EdFi_Ods_2021.edfi.CredentialGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CredentialIdentifier
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.CredentialFieldDescriptor AS target
        USING EdFi_Ods_2021.edfi.CredentialFieldDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CredentialFieldDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CredentialFieldDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialFieldDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CredentialFieldDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialFieldDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CredentialTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CredentialTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CredentialTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CredentialTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CredentialTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CredentialTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CreditCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.CreditCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CreditCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CreditCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CreditCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CreditTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.CreditTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CreditTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CreditTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CreditTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CTEProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.CTEProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CTEProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CTEProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.CurriculumUsedDescriptor AS target
        USING EdFi_Ods_2021.edfi.CurriculumUsedDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CurriculumUsedDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , CurriculumUsedDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CurriculumUsedDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DeliveryMethodDescriptor AS target
        USING EdFi_Ods_2021.edfi.DeliveryMethodDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DeliveryMethodDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DeliveryMethodDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Descriptor AS target
        USING EdFi_Ods_2021.edfi.Descriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CodeValue = source.CodeValue
            , target.Description = source.Description
            , target.EffectiveBeginDate = source.EffectiveBeginDate
            , target.EffectiveEndDate = source.EffectiveEndDate
            , target.Namespace = source.Namespace
            , target.PriorDescriptorId = source.PriorDescriptorId
            , target.ShortDescription = source.ShortDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DescriptorId
                -- Identifying references
                -- Attributes
                , CodeValue
                , Description
                , EffectiveBeginDate
                , EffectiveEndDate
                , Namespace
                , PriorDescriptorId
                , ShortDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DescriptorId
                -- Identifying references
                -- Attributes
                , CodeValue
                , Description
                , EffectiveBeginDate
                , EffectiveEndDate
                , Namespace
                , PriorDescriptorId
                , ShortDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.DiagnosisDescriptor AS target
        USING EdFi_Ods_2021.edfi.DiagnosisDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiagnosisDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DiagnosisDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DiagnosisDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DiplomaLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.DiplomaLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiplomaLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DiplomaLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DiplomaLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DiplomaTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.DiplomaTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DiplomaTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DiplomaTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisabilityDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisabilityDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisabilityDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisabilityDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisabilityDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisabilityDesignationDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisabilityDesignationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisabilityDesignationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisabilityDesignationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisabilityDeterminationSourceTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisabilityDeterminationSourceTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisabilityDeterminationSourceTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisabilityDeterminationSourceTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisciplineAction AS target
        USING EdFi_Ods_2021.edfi.DisciplineAction AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.DisciplineActionIdentifier
        + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ActualDisciplineActionLength = source.ActualDisciplineActionLength
            , target.DisciplineActionLength = source.DisciplineActionLength
            , target.IEPPlacementMeetingIndicator = source.IEPPlacementMeetingIndicator
            , target.ReceivedEducationServicesDuringExpulsion = source.ReceivedEducationServicesDuringExpulsion
            , target.RelatedToZeroTolerancePolicy = source.RelatedToZeroTolerancePolicy
                -- References
            , target.DisciplineActionLengthDifferenceReasonDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineActionLengthDifferenceReasonDescriptorId)
                )
            , target.ResponsibilitySchoolHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponsibilitySchoolId)
                )
            , target.AssignmentSchoolHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssignmentSchoolId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisciplineActionIdentifier
                , DisciplineDate
                , StudentUSI
                -- Identifying references
                , StudentHashKey
                -- Attributes
                , ActualDisciplineActionLength
                , DisciplineActionLength
                , IEPPlacementMeetingIndicator
                , ReceivedEducationServicesDuringExpulsion
                , RelatedToZeroTolerancePolicy
                -- References
                , DisciplineActionLengthDifferenceReasonDescriptorHashKey
                , ResponsibilitySchoolHashKey
                , AssignmentSchoolHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.DisciplineActionIdentifier
                + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisciplineActionIdentifier
                , DisciplineDate
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , ActualDisciplineActionLength
                , DisciplineActionLength
                , IEPPlacementMeetingIndicator
                , ReceivedEducationServicesDuringExpulsion
                , RelatedToZeroTolerancePolicy
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineActionLengthDifferenceReasonDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponsibilitySchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssignmentSchoolId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.DisciplineActionDiscipline AS target
        USING EdFi_Ods_2021.edfi.DisciplineActionDiscipline AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.DisciplineActionIdentifier
        + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
        + '|' +     CONVERT(nvarchar, source.DisciplineDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisciplineDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisciplineDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisciplineDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.DisciplineActionIdentifier
                + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
                + '|' +     CONVERT(nvarchar, source.DisciplineDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineActionStaff AS target
        USING EdFi_Ods_2021.edfi.DisciplineActionStaff AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.DisciplineActionIdentifier
        + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StaffHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StaffUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StaffHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.DisciplineActionIdentifier
                + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineActionStudentDisciplineIncidentAssociation AS target
        USING EdFi_Ods_2021.edfi.DisciplineActionStudentDisciplineIncidentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.DisciplineActionIdentifier
        + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
        + '|' +     source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentDisciplineIncidentAssociationHashKey = HASHBYTES('sha1',
                source.IncidentIdentifier
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentDisciplineIncidentAssociationHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.DisciplineActionIdentifier
                + '|' +     CONVERT(nvarchar, source.DisciplineDate, 23)
                + '|' +     source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineActionLengthDifferenceReasonDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisciplineActionLengthDifferenceReasonDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisciplineActionLengthDifferenceReasonDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisciplineActionLengthDifferenceReasonDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineActionLengthDifferenceReasonDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisciplineActionLengthDifferenceReasonDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineActionLengthDifferenceReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisciplineDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisciplineDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisciplineDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisciplineDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisciplineDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.DisciplineIncident AS target
        USING EdFi_Ods_2021.edfi.DisciplineIncident AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CaseNumber = source.CaseNumber
            , target.IncidentCost = source.IncidentCost
            , target.IncidentDate = source.IncidentDate
            , target.IncidentDescription = source.IncidentDescription
            , target.IncidentTime = source.IncidentTime
            , target.ReportedToLawEnforcement = source.ReportedToLawEnforcement
            , target.ReporterName = source.ReporterName
                -- References
            , target.IncidentLocationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IncidentLocationDescriptorId)
                )
            , target.ReporterDescriptionDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReporterDescriptionDescriptorId)
                )
            , target.StaffHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                -- Identifying references
                , SchoolHashKey
                -- Attributes
                , CaseNumber
                , IncidentCost
                , IncidentDate
                , IncidentDescription
                , IncidentTime
                , ReportedToLawEnforcement
                , ReporterName
                -- References
                , IncidentLocationDescriptorHashKey
                , ReporterDescriptionDescriptorHashKey
                , StaffHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , CaseNumber
                , IncidentCost
                , IncidentDate
                , IncidentDescription
                , IncidentTime
                , ReportedToLawEnforcement
                , ReporterName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IncidentLocationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReporterDescriptionDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.DisciplineIncidentBehavior AS target
        USING EdFi_Ods_2021.edfi.DisciplineIncidentBehavior AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BehaviorDescriptorId)
        + '|' +     source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.BehaviorDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BehaviorDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BehaviorDetailedDescription = source.BehaviorDetailedDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , BehaviorDescriptorHashKey
                -- Attributes
                , BehaviorDetailedDescription
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                + '|' +     source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                )
                -- Attributes
                , BehaviorDetailedDescription
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineIncidentExternalParticipant AS target
        USING EdFi_Ods_2021.edfi.DisciplineIncidentExternalParticipant AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
        + '|' +     source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisciplineIncidentParticipationCodeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
            )
            -- Contextual primary key
            AND target.FirstName = source.FirstName
            AND target.LastSurname = source.LastSurname
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisciplineIncidentParticipationCodeDescriptorHashKey
                -- Contextual primary key
                , FirstName
                , LastSurname
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                + '|' +     source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                )
                -- Contextual primary key
                , FirstName
                , LastSurname
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineIncidentWeapon AS target
        USING EdFi_Ods_2021.edfi.DisciplineIncidentWeapon AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.WeaponDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.WeaponDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.WeaponDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , WeaponDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.WeaponDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WeaponDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.DisciplineIncidentParticipationCodeDescriptor AS target
        USING EdFi_Ods_2021.edfi.DisciplineIncidentParticipationCodeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DisciplineIncidentParticipationCodeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , DisciplineIncidentParticipationCodeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationalEnvironmentDescriptor AS target
        USING EdFi_Ods_2021.edfi.EducationalEnvironmentDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationalEnvironmentDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationalEnvironmentDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationContent AS target
        USING EdFi_Ods_2021.edfi.EducationContent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AdditionalAuthorsIndicator = source.AdditionalAuthorsIndicator
            , target.Cost = source.Cost
            , target.Description = source.Description
            , target.LearningResourceMetadataURI = source.LearningResourceMetadataURI
            , target.Namespace = source.Namespace
            , target.PublicationDate = source.PublicationDate
            , target.PublicationYear = source.PublicationYear
            , target.Publisher = source.Publisher
            , target.ShortDescription = source.ShortDescription
            , target.TimeRequired = source.TimeRequired
            , target.UseRightsURL = source.UseRightsURL
            , target.Version = source.Version
                -- References
            , target.ContentClassDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContentClassDescriptorId)
                )
            , target.CostRateDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CostRateDescriptorId)
                )
            , target.InteractivityStyleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InteractivityStyleDescriptorId)
                )
            , target.LearningStandardHashKey = HASHBYTES('sha1', 
                    source.LearningStandardId
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ContentIdentifier
                -- Identifying references
                -- Attributes
                , AdditionalAuthorsIndicator
                , Cost
                , Description
                , LearningResourceMetadataURI
                , Namespace
                , PublicationDate
                , PublicationYear
                , Publisher
                , ShortDescription
                , TimeRequired
                , UseRightsURL
                , Version
                -- References
                , ContentClassDescriptorHashKey
                , CostRateDescriptorHashKey
                , InteractivityStyleDescriptorHashKey
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , ContentIdentifier
                -- Identifying references
                -- Attributes
                , AdditionalAuthorsIndicator
                , Cost
                , Description
                , LearningResourceMetadataURI
                , Namespace
                , PublicationDate
                , PublicationYear
                , Publisher
                , ShortDescription
                , TimeRequired
                , UseRightsURL
                , Version
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContentClassDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CostRateDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InteractivityStyleDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.EducationContentAppropriateGradeLevel AS target
        USING EdFi_Ods_2021.edfi.EducationContentAppropriateGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentAppropriateSex AS target
        USING EdFi_Ods_2021.edfi.EducationContentAppropriateSex AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SexDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SexDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentAuthor AS target
        USING EdFi_Ods_2021.edfi.EducationContentAuthor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.Author = source.Author
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentDerivativeSourceEducationContent AS target
        USING EdFi_Ods_2021.edfi.EducationContentDerivativeSourceEducationContent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     source.DerivativeSourceContentIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     source.DerivativeSourceContentIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentDerivativeSourceLearningResourceMetadataURI AS target
        USING EdFi_Ods_2021.edfi.EducationContentDerivativeSourceLearningResourceMetadataURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.DerivativeSourceLearningResourceMetadataURI = source.DerivativeSourceLearningResourceMetadataURI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , DerivativeSourceLearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , DerivativeSourceLearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentDerivativeSourceURI AS target
        USING EdFi_Ods_2021.edfi.EducationContentDerivativeSourceURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.DerivativeSourceURI = source.DerivativeSourceURI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , DerivativeSourceURI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , DerivativeSourceURI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationContentLanguage AS target
        USING EdFi_Ods_2021.edfi.EducationContentLanguage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganization AS target
        USING EdFi_Ods_2021.edfi.EducationOrganization AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.NameOfInstitution = source.NameOfInstitution
            , target.ShortNameOfInstitution = source.ShortNameOfInstitution
            , target.WebSite = source.WebSite
                -- References
            , target.OperationalStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OperationalStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                -- Identifying references
                -- Attributes
                , NameOfInstitution
                , ShortNameOfInstitution
                , WebSite
                -- References
                , OperationalStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                -- Identifying references
                -- Attributes
                , NameOfInstitution
                , ShortNameOfInstitution
                , WebSite
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OperationalStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.EducationOrganizationAddress AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
            AND target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            -- Contextual primary key
            AND target.City = source.City
            AND target.PostalCode = source.PostalCode
            AND target.StreetNumberName = source.StreetNumberName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ApartmentRoomSuiteNumber = source.ApartmentRoomSuiteNumber
            , target.BuildingSiteNumber = source.BuildingSiteNumber
            , target.CongressionalDistrict = source.CongressionalDistrict
            , target.CountyFIPSCode = source.CountyFIPSCode
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
            , target.NameOfCounty = source.NameOfCounty
                -- References
            , target.LocaleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                , StateAbbreviationDescriptorHashKey
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , LocaleDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationAddressPeriod AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationAddressPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     source.City
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.PostalCode
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
        + '|' +     source.StreetNumberName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     source.City
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.PostalCode
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                + '|' +     source.StreetNumberName
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationCategory AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationCategory AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationOrganizationCategoryDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationOrganizationCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationOrganizationIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationOrganizationIdentificationSystemDescriptorHashKey
                -- Attributes
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
                )
                -- Attributes
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationIndicator AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationIndicator AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.IndicatorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IndicatorDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IndicatorDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DesignatedBy = source.DesignatedBy
            , target.IndicatorValue = source.IndicatorValue
                -- References
            , target.IndicatorGroupDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorGroupDescriptorId)
                )
            , target.IndicatorLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IndicatorDescriptorHashKey
                -- Attributes
                , DesignatedBy
                , IndicatorValue
                -- References
                , IndicatorGroupDescriptorHashKey
                , IndicatorLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.IndicatorDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorDescriptorId)
                )
                -- Attributes
                , DesignatedBy
                , IndicatorValue
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorGroupDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationIndicatorPeriod AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationIndicatorPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.IndicatorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.IndicatorDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationInstitutionTelephone AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationInstitutionTelephone AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.InstitutionTelephoneNumberTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.TelephoneNumber = source.TelephoneNumber
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , InstitutionTelephoneNumberTypeDescriptorHashKey
                -- Attributes
                , TelephoneNumber
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
                )
                -- Attributes
                , TelephoneNumber
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationInternationalAddress AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationInternationalAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AddressLine1 = source.AddressLine1
            , target.AddressLine2 = source.AddressLine2
            , target.AddressLine3 = source.AddressLine3
            , target.AddressLine4 = source.AddressLine4
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
                -- References
            , target.CountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , CountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.EducationOrganizationCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationOrganizationIdentificationSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationIdentificationSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationIdentificationSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationIdentificationSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationIdentificationSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationOrganizationInterventionPrescriptionAssociation AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationInterventionPrescriptionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionPrescriptionEducationOrganizationId
                , InterventionPrescriptionIdentificationCode
                -- Identifying references
                , EducationOrganizationHashKey
                , InterventionPrescriptionHashKey
                -- Attributes
                , BeginDate
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionPrescriptionEducationOrganizationId
                , InterventionPrescriptionIdentificationCode
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                -- Attributes
                , BeginDate
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.EducationOrganizationNetwork AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationNetwork AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationNetworkId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.NetworkPurposeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NetworkPurposeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationNetworkId
                -- Identifying references
                , EducationOrganizationHashKey
                -- References
                , NetworkPurposeDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationNetworkId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationNetworkId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationNetworkId)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NetworkPurposeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationOrganizationNetworkAssociation AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationNetworkAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationNetworkId)
        + '|' +     CONVERT(nvarchar, source.MemberEducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationNetworkId
                , MemberEducationOrganizationId
                -- Identifying references
                , MemberEducationOrganizationHashKey
                , EducationOrganizationNetworkHashKey
                -- Attributes
                , BeginDate
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationNetworkId)
                + '|' +     CONVERT(nvarchar, source.MemberEducationOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationNetworkId
                , MemberEducationOrganizationId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MemberEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationNetworkId)
                )
                -- Attributes
                , BeginDate
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.EducationOrganizationPeerAssociation AS target
        USING EdFi_Ods_2021.edfi.EducationOrganizationPeerAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.PeerEducationOrganizationId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , PeerEducationOrganizationId
                -- Identifying references
                , EducationOrganizationHashKey
                , PeerEducationOrganizationHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.PeerEducationOrganizationId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , PeerEducationOrganizationId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PeerEducationOrganizationId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.EducationPlanDescriptor AS target
        USING EdFi_Ods_2021.edfi.EducationPlanDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationPlanDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationPlanDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationPlanDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationPlanDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationPlanDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EducationServiceCenter AS target
        USING EdFi_Ods_2021.edfi.EducationServiceCenter AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationServiceCenterId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.StateEducationAgencyHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationServiceCenterId
                -- Identifying references
                , EducationOrganizationHashKey
                -- References
                , StateEducationAgencyHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationServiceCenterId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationServiceCenterId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationServiceCenterId)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ElectronicMailTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.ElectronicMailTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ElectronicMailTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ElectronicMailTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EmploymentStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.EmploymentStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EmploymentStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EmploymentStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EntryGradeLevelReasonDescriptor AS target
        USING EdFi_Ods_2021.edfi.EntryGradeLevelReasonDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EntryGradeLevelReasonDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EntryGradeLevelReasonDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelReasonDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EntryGradeLevelReasonDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EntryTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.EntryTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EntryTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EntryTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EntryTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.EventCircumstanceDescriptor AS target
        USING EdFi_Ods_2021.edfi.EventCircumstanceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EventCircumstanceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EventCircumstanceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EventCircumstanceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EventCircumstanceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EventCircumstanceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ExitWithdrawTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.ExitWithdrawTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ExitWithdrawTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ExitWithdrawTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExitWithdrawTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ExitWithdrawTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExitWithdrawTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.FeederSchoolAssociation AS target
        USING EdFi_Ods_2021.edfi.FeederSchoolAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.FeederSchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.FeederRelationshipDescription = source.FeederRelationshipDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , FeederSchoolId
                , SchoolId
                -- Identifying references
                , FeederSchoolHashKey
                , SchoolHashKey
                -- Attributes
                , EndDate
                , FeederRelationshipDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.FeederSchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , FeederSchoolId
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.FeederSchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , EndDate
                , FeederRelationshipDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GeneralStudentProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.GeneralStudentProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.ServedOutsideOfRegularSession = source.ServedOutsideOfRegularSession
                -- References
            , target.ReasonExitedDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonExitedDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , ProgramHashKey
                , StudentHashKey
                -- Attributes
                , EndDate
                , ServedOutsideOfRegularSession
                -- References
                , ReasonExitedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EndDate
                , ServedOutsideOfRegularSession
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonExitedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GeneralStudentProgramAssociationParticipationStatus AS target
        USING EdFi_Ods_2021.edfi.GeneralStudentProgramAssociationParticipationStatus AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DesignatedBy = source.DesignatedBy
            , target.StatusBeginDate = source.StatusBeginDate
            , target.StatusEndDate = source.StatusEndDate
                -- References
            , target.ParticipationStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , DesignatedBy
                , StatusBeginDate
                , StatusEndDate
                -- References
                , ParticipationStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , DesignatedBy
                , StatusBeginDate
                , StatusEndDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.Grade AS target
        USING EdFi_Ods_2021.edfi.Grade AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DiagnosticStatement = source.DiagnosticStatement
            , target.LetterGradeEarned = source.LetterGradeEarned
            , target.NumericGradeEarned = source.NumericGradeEarned
                -- References
            , target.PerformanceBaseConversionDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , GradeTypeDescriptorId
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , GradeTypeDescriptorHashKey
                , GradingPeriodHashKey
                , StudentSectionAssociationHashKey
                -- Attributes
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , PerformanceBaseConversionDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , GradeTypeDescriptorId
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GradeLearningStandardGrade AS target
        USING EdFi_Ods_2021.edfi.GradeLearningStandardGrade AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LearningStandardId
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DiagnosticStatement = source.DiagnosticStatement
            , target.LetterGradeEarned = source.LetterGradeEarned
            , target.NumericGradeEarned = source.NumericGradeEarned
                -- References
            , target.PerformanceBaseConversionDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Attributes
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , PerformanceBaseConversionDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningStandardId
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Attributes
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GradebookEntry AS target
        USING EdFi_Ods_2021.edfi.GradebookEntry AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DateAssigned, 23)
        + '|' +     source.GradebookEntryTitle
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Description = source.Description
            , target.DueDate = source.DueDate
                -- References
            , target.GradebookEntryTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradebookEntryTypeDescriptorId)
                )
            , target.GradingPeriodHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , DateAssigned
                , GradebookEntryTitle
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , SectionHashKey
                -- Attributes
                , Description
                , DueDate
                -- References
                , GradebookEntryTypeDescriptorHashKey
                , GradingPeriodHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DateAssigned, 23)
                + '|' +     source.GradebookEntryTitle
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Primary key columns
                , DateAssigned
                , GradebookEntryTitle
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                -- Attributes
                , Description
                , DueDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradebookEntryTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GradebookEntryLearningObjective AS target
        USING EdFi_Ods_2021.edfi.GradebookEntryLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DateAssigned, 23)
        + '|' +     source.GradebookEntryTitle
        + '|' +     source.LearningObjectiveId
        + '|' +     source.LocalCourseCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningObjectiveHashKey = HASHBYTES('sha1',
                source.LearningObjectiveId
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DateAssigned, 23)
                + '|' +     source.GradebookEntryTitle
                + '|' +     source.LearningObjectiveId
                + '|' +     source.LocalCourseCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GradebookEntryLearningStandard AS target
        USING EdFi_Ods_2021.edfi.GradebookEntryLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DateAssigned, 23)
        + '|' +     source.GradebookEntryTitle
        + '|' +     source.LearningStandardId
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DateAssigned, 23)
                + '|' +     source.GradebookEntryTitle
                + '|' +     source.LearningStandardId
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GradebookEntryTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.GradebookEntryTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradebookEntryTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradebookEntryTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradebookEntryTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradebookEntryTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradebookEntryTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GradeLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.GradeLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradeLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradeLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GradePointAverageTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.GradePointAverageTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradePointAverageTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradePointAverageTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GradeTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.GradeTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradeTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradeTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GradingPeriod AS target
        USING EdFi_Ods_2021.edfi.GradingPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PeriodSequence)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.TotalInstructionalDays = source.TotalInstructionalDays
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , PeriodSequence
                , SchoolId
                , SchoolYear
                -- Identifying references
                , GradingPeriodDescriptorHashKey
                , SchoolHashKey
                , SchoolYearTypeHashKey
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , PeriodSequence
                , SchoolId
                , SchoolYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GradingPeriodDescriptor AS target
        USING EdFi_Ods_2021.edfi.GradingPeriodDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GraduationPlan AS target
        USING EdFi_Ods_2021.edfi.GraduationPlan AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.IndividualPlan = source.IndividualPlan
            , target.TotalRequiredCreditConversion = source.TotalRequiredCreditConversion
            , target.TotalRequiredCredits = source.TotalRequiredCredits
                -- References
            , target.TotalRequiredCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TotalRequiredCreditTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , GraduationPlanTypeDescriptorId
                , GraduationSchoolYear
                -- Identifying references
                , EducationOrganizationHashKey
                , GraduationPlanTypeDescriptorHashKey
                , GraduationSchoolYearTypeHashKey
                -- Attributes
                , IndividualPlan
                , TotalRequiredCreditConversion
                , TotalRequiredCredits
                -- References
                , TotalRequiredCreditTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , GraduationPlanTypeDescriptorId
                , GraduationSchoolYear
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                -- Attributes
                , IndividualPlan
                , TotalRequiredCreditConversion
                , TotalRequiredCredits
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TotalRequiredCreditTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.GraduationPlanCreditsByCourse AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanCreditsByCourse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.CourseSetName = source.CourseSetName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CreditConversion = source.CreditConversion
            , target.Credits = source.Credits
                -- References
            , target.CreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
            , target.WhenTakenGradeLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenTakenGradeLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , CourseSetName
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , CreditTypeDescriptorHashKey
                , WhenTakenGradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , CourseSetName
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenTakenGradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanCreditsByCourseCourse AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanCreditsByCourseCourse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
        + '|' +     source.CourseSetName
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseHashKey = HASHBYTES('sha1',
                source.CourseCode
            + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                + '|' +     source.CourseSetName
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.CourseEducationOrganizationId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanCreditsByCreditCategory AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanCreditsByCreditCategory AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CreditCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CreditCategoryDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CreditCategoryDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CreditConversion = source.CreditConversion
            , target.Credits = source.Credits
                -- References
            , target.CreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CreditCategoryDescriptorHashKey
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , CreditTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditCategoryDescriptorId)
                )
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanCreditsBySubject AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanCreditsBySubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CreditConversion = source.CreditConversion
            , target.Credits = source.Credits
                -- References
            , target.CreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , CreditTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Attributes
                , CreditConversion
                , Credits
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CreditTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanRequiredAssessment AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanRequiredAssessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentHashKey = HASHBYTES('sha1',
                source.AssessmentIdentifier
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanRequiredAssessmentPerformanceLevel AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanRequiredAssessmentPerformanceLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
            , target.PerformanceLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , AssessmentReportingMethodDescriptorHashKey
                , PerformanceLevelDescriptorHashKey
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanRequiredAssessmentScore AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanRequiredAssessmentScore AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.GraduationPlanTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.GraduationPlanTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GraduationPlanTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GraduationPlanTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.GunFreeSchoolsActReportingStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.GunFreeSchoolsActReportingStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GunFreeSchoolsActReportingStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GunFreeSchoolsActReportingStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GunFreeSchoolsActReportingStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , GunFreeSchoolsActReportingStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GunFreeSchoolsActReportingStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.HomelessPrimaryNighttimeResidenceDescriptor AS target
        USING EdFi_Ods_2021.edfi.HomelessPrimaryNighttimeResidenceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.HomelessPrimaryNighttimeResidenceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , HomelessPrimaryNighttimeResidenceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessPrimaryNighttimeResidenceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , HomelessPrimaryNighttimeResidenceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessPrimaryNighttimeResidenceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.HomelessProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.HomelessProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , HomelessProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , HomelessProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.IdentificationDocumentUseDescriptor AS target
        USING EdFi_Ods_2021.edfi.IdentificationDocumentUseDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IdentificationDocumentUseDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IdentificationDocumentUseDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.IncidentLocationDescriptor AS target
        USING EdFi_Ods_2021.edfi.IncidentLocationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IncidentLocationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IncidentLocationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IncidentLocationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IncidentLocationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IncidentLocationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.IndicatorDescriptor AS target
        USING EdFi_Ods_2021.edfi.IndicatorDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IndicatorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IndicatorDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IndicatorDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.IndicatorGroupDescriptor AS target
        USING EdFi_Ods_2021.edfi.IndicatorGroupDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IndicatorGroupDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IndicatorGroupDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorGroupDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IndicatorGroupDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorGroupDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.IndicatorLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.IndicatorLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IndicatorLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IndicatorLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , IndicatorLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IndicatorLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.InstitutionTelephoneNumberTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.InstitutionTelephoneNumberTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , InstitutionTelephoneNumberTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , InstitutionTelephoneNumberTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InstitutionTelephoneNumberTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.InteractivityStyleDescriptor AS target
        USING EdFi_Ods_2021.edfi.InteractivityStyleDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.InteractivityStyleDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , InteractivityStyleDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InteractivityStyleDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , InteractivityStyleDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InteractivityStyleDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.InternetAccessDescriptor AS target
        USING EdFi_Ods_2021.edfi.InternetAccessDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.InternetAccessDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , InternetAccessDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InternetAccessDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , InternetAccessDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InternetAccessDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Intervention AS target
        USING EdFi_Ods_2021.edfi.Intervention AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.MaxDosage = source.MaxDosage
            , target.MinDosage = source.MinDosage
                -- References
            , target.DeliveryMethodDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
            , target.InterventionClassDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionIdentificationCode
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , BeginDate
                , EndDate
                , MaxDosage
                , MinDosage
                -- References
                , DeliveryMethodDescriptorHashKey
                , InterventionClassDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionIdentificationCode
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , BeginDate
                , EndDate
                , MaxDosage
                , MinDosage
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.InterventionAppropriateGradeLevel AS target
        USING EdFi_Ods_2021.edfi.InterventionAppropriateGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionAppropriateSex AS target
        USING EdFi_Ods_2021.edfi.InterventionAppropriateSex AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SexDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SexDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionDiagnosis AS target
        USING EdFi_Ods_2021.edfi.InterventionDiagnosis AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiagnosisDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DiagnosisDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DiagnosisDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DiagnosisDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionEducationContent AS target
        USING EdFi_Ods_2021.edfi.InterventionEducationContent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationContentHashKey = HASHBYTES('sha1',
                source.ContentIdentifier
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationContentHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionInterventionPrescription AS target
        USING EdFi_Ods_2021.edfi.InterventionInterventionPrescription AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.InterventionPrescriptionHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
            + '|' +     source.InterventionPrescriptionIdentificationCode
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , InterventionPrescriptionHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionLearningResourceMetadataURI AS target
        USING EdFi_Ods_2021.edfi.InterventionLearningResourceMetadataURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.LearningResourceMetadataURI = source.LearningResourceMetadataURI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionMeetingTime AS target
        USING EdFi_Ods_2021.edfi.InterventionMeetingTime AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.EndTime = source.EndTime
            AND target.StartTime = source.StartTime
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , EndTime
                , StartTime
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , EndTime
                , StartTime
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPopulationServed AS target
        USING EdFi_Ods_2021.edfi.InterventionPopulationServed AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.PopulationServedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , PopulationServedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStaff AS target
        USING EdFi_Ods_2021.edfi.InterventionStaff AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StaffHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StaffUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StaffHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionURI AS target
        USING EdFi_Ods_2021.edfi.InterventionURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.URI = source.URI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionClassDescriptor AS target
        USING EdFi_Ods_2021.edfi.InterventionClassDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.InterventionClassDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , InterventionClassDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , InterventionClassDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.InterventionEffectivenessRatingDescriptor AS target
        USING EdFi_Ods_2021.edfi.InterventionEffectivenessRatingDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , InterventionEffectivenessRatingDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , InterventionEffectivenessRatingDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.InterventionPrescription AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescription AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.MaxDosage = source.MaxDosage
            , target.MinDosage = source.MinDosage
                -- References
            , target.DeliveryMethodDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
            , target.InterventionClassDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionPrescriptionIdentificationCode
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , MaxDosage
                , MinDosage
                -- References
                , DeliveryMethodDescriptorHashKey
                , InterventionClassDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionPrescriptionIdentificationCode
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , MaxDosage
                , MinDosage
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.InterventionPrescriptionAppropriateGradeLevel AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionAppropriateGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionAppropriateSex AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionAppropriateSex AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SexDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SexDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionDiagnosis AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionDiagnosis AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiagnosisDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DiagnosisDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DiagnosisDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DiagnosisDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionEducationContent AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionEducationContent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationContentHashKey = HASHBYTES('sha1',
                source.ContentIdentifier
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationContentHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionLearningResourceMetadataURI AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionLearningResourceMetadataURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.LearningResourceMetadataURI = source.LearningResourceMetadataURI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionPopulationServed AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionPopulationServed AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.PopulationServedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , PopulationServedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionPrescriptionURI AS target
        USING EdFi_Ods_2021.edfi.InterventionPrescriptionURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionPrescriptionIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.URI = source.URI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudy AS target
        USING EdFi_Ods_2021.edfi.InterventionStudy AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Participants = source.Participants
                -- References
            , target.DeliveryMethodDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
            , target.InterventionClassDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
            , target.InterventionPrescriptionHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionStudyIdentificationCode
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , Participants
                -- References
                , DeliveryMethodDescriptorHashKey
                , InterventionClassDescriptorHashKey
                , InterventionPrescriptionHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionStudyIdentificationCode
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , Participants
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DeliveryMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionClassDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionPrescriptionEducationOrganizationId)
                + '|' +     source.InterventionPrescriptionIdentificationCode
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.InterventionStudyAppropriateGradeLevel AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyAppropriateGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.InterventionStudyIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.InterventionStudyIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyAppropriateSex AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyAppropriateSex AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
        + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SexDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SexDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                + '|' +     CONVERT(nvarchar, source.SexDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyEducationContent AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyEducationContent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContentIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationContentHashKey = HASHBYTES('sha1',
                source.ContentIdentifier
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationContentHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContentIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.ContentIdentifier
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyInterventionEffectiveness AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyInterventionEffectiveness AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiagnosisDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.InterventionStudyIdentificationCode
        + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DiagnosisDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DiagnosisDescriptorId)
            )
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
            AND target.PopulationServedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ImprovementIndex = source.ImprovementIndex
                -- References
            , target.InterventionEffectivenessRatingDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DiagnosisDescriptorHashKey
                , GradeLevelDescriptorHashKey
                , PopulationServedDescriptorHashKey
                -- Attributes
                , ImprovementIndex
                -- References
                , InterventionEffectivenessRatingDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.InterventionStudyIdentificationCode
                + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Attributes
                , ImprovementIndex
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyLearningResourceMetadataURI AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyLearningResourceMetadataURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.LearningResourceMetadataURI = source.LearningResourceMetadataURI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , LearningResourceMetadataURI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyPopulationServed AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyPopulationServed AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
        + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.PopulationServedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , PopulationServedDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyStateAbbreviation AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyStateAbbreviation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StateAbbreviationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.InterventionStudyURI AS target
        USING EdFi_Ods_2021.edfi.InterventionStudyURI AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionStudyIdentificationCode
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.URI = source.URI
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionStudyIdentificationCode
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , URI
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LanguageDescriptor AS target
        USING EdFi_Ods_2021.edfi.LanguageDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LanguageDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LanguageDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LanguageInstructionProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.LanguageInstructionProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LanguageInstructionProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LanguageInstructionProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LanguageUseDescriptor AS target
        USING EdFi_Ods_2021.edfi.LanguageUseDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageUseDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LanguageUseDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageUseDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LanguageUseDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageUseDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LearningObjective AS target
        USING EdFi_Ods_2021.edfi.LearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Description = source.Description
            , target.Nomenclature = source.Nomenclature
            , target.Objective = source.Objective
            , target.SuccessCriteria = source.SuccessCriteria
                -- References
            , target.ParentLearningObjectiveHashKey = HASHBYTES('sha1', 
                    source.ParentLearningObjectiveId
                + '|' +     source.ParentNamespace
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LearningObjectiveId
                , Namespace
                -- Identifying references
                -- Attributes
                , Description
                , Nomenclature
                , Objective
                , SuccessCriteria
                -- References
                , ParentLearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Primary key columns
                , LearningObjectiveId
                , Namespace
                -- Identifying references
                -- Attributes
                , Description
                , Nomenclature
                , Objective
                , SuccessCriteria
                -- References
                , HASHBYTES('sha1', 
                    source.ParentLearningObjectiveId
                + '|' +     source.ParentNamespace
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.LearningObjectiveAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.LearningObjectiveAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningObjectiveContentStandard AS target
        USING EdFi_Ods_2021.edfi.LearningObjectiveContentStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.PublicationDate = source.PublicationDate
            , target.PublicationYear = source.PublicationYear
            , target.Title = source.Title
            , target.URI = source.URI
            , target.Version = source.Version
                -- References
            , target.MandatingEducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
            , target.PublicationStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , MandatingEducationOrganizationHashKey
                , PublicationStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningObjectiveContentStandardAuthor AS target
        USING EdFi_Ods_2021.edfi.LearningObjectiveContentStandardAuthor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.Author = source.Author
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningObjectiveGradeLevel AS target
        USING EdFi_Ods_2021.edfi.LearningObjectiveGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningObjectiveLearningStandard AS target
        USING EdFi_Ods_2021.edfi.LearningObjectiveLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningObjectiveId
        + '|' +     source.LearningStandardId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.LearningStandardId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandard AS target
        USING EdFi_Ods_2021.edfi.LearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CourseTitle = source.CourseTitle
            , target.Description = source.Description
            , target.LearningStandardItemCode = source.LearningStandardItemCode
            , target.Namespace = source.Namespace
            , target.SuccessCriteria = source.SuccessCriteria
            , target.URI = source.URI
                -- References
            , target.ParentLearningStandardHashKey = HASHBYTES('sha1', 
                    source.ParentLearningStandardId
                )
            , target.LearningStandardCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardCategoryDescriptorId)
                )
            , target.LearningStandardScopeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardScopeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LearningStandardId
                -- Identifying references
                -- Attributes
                , CourseTitle
                , Description
                , LearningStandardItemCode
                , Namespace
                , SuccessCriteria
                , URI
                -- References
                , ParentLearningStandardHashKey
                , LearningStandardCategoryDescriptorHashKey
                , LearningStandardScopeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                , @schoolYearContext
                -- Primary key columns
                , LearningStandardId
                -- Identifying references
                -- Attributes
                , CourseTitle
                , Description
                , LearningStandardItemCode
                , Namespace
                , SuccessCriteria
                , URI
                -- References
                , HASHBYTES('sha1', 
                    source.ParentLearningStandardId
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardScopeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.LearningStandardAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.LearningStandardAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardContentStandard AS target
        USING EdFi_Ods_2021.edfi.LearningStandardContentStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.PublicationDate = source.PublicationDate
            , target.PublicationYear = source.PublicationYear
            , target.Title = source.Title
            , target.URI = source.URI
            , target.Version = source.Version
                -- References
            , target.MandatingEducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
            , target.PublicationStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , MandatingEducationOrganizationHashKey
                , PublicationStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , BeginDate
                , EndDate
                , PublicationDate
                , PublicationYear
                , Title
                , URI
                , Version
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MandatingEducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardContentStandardAuthor AS target
        USING EdFi_Ods_2021.edfi.LearningStandardContentStandardAuthor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.Author = source.Author
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , Author
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardGradeLevel AS target
        USING EdFi_Ods_2021.edfi.LearningStandardGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.LearningStandardIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.ContentStandardName = source.ContentStandardName
            AND target.IdentificationCode = source.IdentificationCode
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , ContentStandardName
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , ContentStandardName
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardPrerequisiteLearningStandard AS target
        USING EdFi_Ods_2021.edfi.LearningStandardPrerequisiteLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LearningStandardId
        + '|' +     source.PrerequisiteLearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LearningStandardId
                + '|' +     source.PrerequisiteLearningStandardId
                )
                , @schoolYearContext
                -- Identifying references
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LearningStandardCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.LearningStandardCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LearningStandardCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LearningStandardCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LearningStandardCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LearningStandardEquivalenceAssociation AS target
        USING EdFi_Ods_2021.edfi.LearningStandardEquivalenceAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SourceLearningStandardId
        + '|' +     source.TargetLearningStandardId
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EffectiveDate = source.EffectiveDate
            , target.LearningStandardEquivalenceStrengthDescription = source.LearningStandardEquivalenceStrengthDescription
                -- References
            , target.LearningStandardEquivalenceStrengthDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardEquivalenceStrengthDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , SourceLearningStandardId
                , TargetLearningStandardId
                -- Identifying references
                , SourceLearningStandardHashKey
                , TargetLearningStandardHashKey
                -- Attributes
                , EffectiveDate
                , LearningStandardEquivalenceStrengthDescription
                -- References
                , LearningStandardEquivalenceStrengthDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SourceLearningStandardId
                + '|' +     source.TargetLearningStandardId
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , SourceLearningStandardId
                , TargetLearningStandardId
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.SourceLearningStandardId
                )
                , HASHBYTES('sha1', 
                    source.TargetLearningStandardId
                )
                -- Attributes
                , EffectiveDate
                , LearningStandardEquivalenceStrengthDescription
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardEquivalenceStrengthDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.LearningStandardEquivalenceStrengthDescriptor AS target
        USING EdFi_Ods_2021.edfi.LearningStandardEquivalenceStrengthDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LearningStandardEquivalenceStrengthDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LearningStandardEquivalenceStrengthDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardEquivalenceStrengthDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LearningStandardEquivalenceStrengthDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardEquivalenceStrengthDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LearningStandardScopeDescriptor AS target
        USING EdFi_Ods_2021.edfi.LearningStandardScopeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LearningStandardScopeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LearningStandardScopeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardScopeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LearningStandardScopeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LearningStandardScopeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LevelOfEducationDescriptor AS target
        USING EdFi_Ods_2021.edfi.LevelOfEducationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LevelOfEducationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LevelOfEducationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LevelOfEducationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LevelOfEducationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LevelOfEducationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LicenseStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.LicenseStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LicenseStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LicenseStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LicenseStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LicenseTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.LicenseTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LicenseTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LicenseTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LicenseTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LicenseTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LimitedEnglishProficiencyDescriptor AS target
        USING EdFi_Ods_2021.edfi.LimitedEnglishProficiencyDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LimitedEnglishProficiencyDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LimitedEnglishProficiencyDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LimitedEnglishProficiencyDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LimitedEnglishProficiencyDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LimitedEnglishProficiencyDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LocaleDescriptor AS target
        USING EdFi_Ods_2021.edfi.LocaleDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LocaleDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocaleDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LocaleDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LocalEducationAgency AS target
        USING EdFi_Ods_2021.edfi.LocalEducationAgency AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LocalEducationAgencyId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.ParentLocalEducationAgencyHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentLocalEducationAgencyId)
                )
            , target.CharterStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
            , target.EducationServiceCenterHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationServiceCenterId)
                )
            , target.LocalEducationAgencyCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyCategoryDescriptorId)
                )
            , target.StateEducationAgencyHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalEducationAgencyId
                -- Identifying references
                , EducationOrganizationHashKey
                -- References
                , ParentLocalEducationAgencyHashKey
                , CharterStatusDescriptorHashKey
                , EducationServiceCenterHashKey
                , LocalEducationAgencyCategoryDescriptorHashKey
                , StateEducationAgencyHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalEducationAgencyId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentLocalEducationAgencyId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationServiceCenterId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.LocalEducationAgencyAccountability AS target
        USING EdFi_Ods_2021.edfi.LocalEducationAgencyAccountability AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LocalEducationAgencyId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SchoolYearTypeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolYear)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
                -- References
            , target.GunFreeSchoolsActReportingStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GunFreeSchoolsActReportingStatusDescriptorId)
                )
            , target.SchoolChoiceImplementStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolChoiceImplementStatusDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SchoolYearTypeHashKey
                -- References
                , GunFreeSchoolsActReportingStatusDescriptorHashKey
                , SchoolChoiceImplementStatusDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GunFreeSchoolsActReportingStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolChoiceImplementStatusDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LocalEducationAgencyFederalFunds AS target
        USING EdFi_Ods_2021.edfi.LocalEducationAgencyFederalFunds AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LocalEducationAgencyId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.FiscalYear = source.FiscalYear
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.InnovativeDollarsSpent = source.InnovativeDollarsSpent
            , target.InnovativeDollarsSpentStrategicPriorities = source.InnovativeDollarsSpentStrategicPriorities
            , target.InnovativeProgramsFundsReceived = source.InnovativeProgramsFundsReceived
            , target.SchoolImprovementAllocation = source.SchoolImprovementAllocation
            , target.SchoolImprovementReservedFundsPercentage = source.SchoolImprovementReservedFundsPercentage
            , target.StateAssessmentAdministrationFunding = source.StateAssessmentAdministrationFunding
            , target.SupplementalEducationalServicesFundsSpent = source.SupplementalEducationalServicesFundsSpent
            , target.SupplementalEducationalServicesPerPupilExpenditure = source.SupplementalEducationalServicesPerPupilExpenditure
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , FiscalYear
                -- Attributes
                , InnovativeDollarsSpent
                , InnovativeDollarsSpentStrategicPriorities
                , InnovativeProgramsFundsReceived
                , SchoolImprovementAllocation
                , SchoolImprovementReservedFundsPercentage
                , StateAssessmentAdministrationFunding
                , SupplementalEducationalServicesFundsSpent
                , SupplementalEducationalServicesPerPupilExpenditure
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , FiscalYear
                -- Attributes
                , InnovativeDollarsSpent
                , InnovativeDollarsSpentStrategicPriorities
                , InnovativeProgramsFundsReceived
                , SchoolImprovementAllocation
                , SchoolImprovementReservedFundsPercentage
                , StateAssessmentAdministrationFunding
                , SupplementalEducationalServicesFundsSpent
                , SupplementalEducationalServicesPerPupilExpenditure
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.LocalEducationAgencyCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.LocalEducationAgencyCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LocalEducationAgencyCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalEducationAgencyCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalEducationAgencyCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Location AS target
        USING EdFi_Ods_2021.edfi.Location AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ClassroomIdentificationCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.MaximumNumberOfSeats = source.MaximumNumberOfSeats
            , target.OptimalNumberOfSeats = source.OptimalNumberOfSeats
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ClassroomIdentificationCode
                , SchoolId
                -- Identifying references
                , SchoolHashKey
                -- Attributes
                , MaximumNumberOfSeats
                , OptimalNumberOfSeats
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ClassroomIdentificationCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ClassroomIdentificationCode
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- Attributes
                , MaximumNumberOfSeats
                , OptimalNumberOfSeats
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.MagnetSpecialProgramEmphasisSchoolDescriptor AS target
        USING EdFi_Ods_2021.edfi.MagnetSpecialProgramEmphasisSchoolDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MagnetSpecialProgramEmphasisSchoolDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , MagnetSpecialProgramEmphasisSchoolDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MagnetSpecialProgramEmphasisSchoolDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , MagnetSpecialProgramEmphasisSchoolDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MagnetSpecialProgramEmphasisSchoolDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.MediumOfInstructionDescriptor AS target
        USING EdFi_Ods_2021.edfi.MediumOfInstructionDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , MediumOfInstructionDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , MediumOfInstructionDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.MethodCreditEarnedDescriptor AS target
        USING EdFi_Ods_2021.edfi.MethodCreditEarnedDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MethodCreditEarnedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , MethodCreditEarnedDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MethodCreditEarnedDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , MethodCreditEarnedDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MethodCreditEarnedDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.MigrantEducationProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.MigrantEducationProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , MigrantEducationProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , MigrantEducationProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.MonitoredDescriptor AS target
        USING EdFi_Ods_2021.edfi.MonitoredDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MonitoredDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , MonitoredDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MonitoredDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , MonitoredDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MonitoredDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.NeglectedOrDelinquentProgramDescriptor AS target
        USING EdFi_Ods_2021.edfi.NeglectedOrDelinquentProgramDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.NeglectedOrDelinquentProgramDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , NeglectedOrDelinquentProgramDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , NeglectedOrDelinquentProgramDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.NeglectedOrDelinquentProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.NeglectedOrDelinquentProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , NeglectedOrDelinquentProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , NeglectedOrDelinquentProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.NetworkPurposeDescriptor AS target
        USING EdFi_Ods_2021.edfi.NetworkPurposeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.NetworkPurposeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , NetworkPurposeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NetworkPurposeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , NetworkPurposeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NetworkPurposeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ObjectiveAssessment AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Description = source.Description
            , target.MaxRawScore = source.MaxRawScore
            , target.Nomenclature = source.Nomenclature
            , target.PercentOfAssessment = source.PercentOfAssessment
                -- References
            , target.ParentObjectiveAssessmentHashKey = HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.ParentIdentificationCode
                + '|' +     source.Namespace
                )
            , target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , IdentificationCode
                , Namespace
                -- Identifying references
                , AssessmentHashKey
                -- Attributes
                , Description
                , MaxRawScore
                , Nomenclature
                , PercentOfAssessment
                -- References
                , ParentObjectiveAssessmentHashKey
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , IdentificationCode
                , Namespace
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                -- Attributes
                , Description
                , MaxRawScore
                , Nomenclature
                , PercentOfAssessment
                -- References
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.ParentIdentificationCode
                + '|' +     source.Namespace
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ObjectiveAssessmentAssessmentItem AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessmentAssessmentItem AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.AssessmentItemIdentificationCode
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentItemHashKey = HASHBYTES('sha1',
                source.AssessmentIdentifier
            + '|' +     source.AssessmentItemIdentificationCode
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentItemHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.AssessmentItemIdentificationCode
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.AssessmentItemIdentificationCode
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ObjectiveAssessmentLearningObjective AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessmentLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.LearningObjectiveId
        + '|' +     source.LearningObjectiveNamespace
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningObjectiveHashKey = HASHBYTES('sha1',
                source.LearningObjectiveId
            + '|' +     source.LearningObjectiveNamespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.LearningObjectiveId
                + '|' +     source.LearningObjectiveNamespace
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.LearningObjectiveNamespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ObjectiveAssessmentLearningStandard AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessmentLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.LearningStandardId
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.LearningStandardId
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ObjectiveAssessmentPerformanceLevel AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessmentPerformanceLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
            AND target.PerformanceLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                , PerformanceLevelDescriptorHashKey
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ObjectiveAssessmentScore AS target
        USING EdFi_Ods_2021.edfi.ObjectiveAssessmentScore AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaximumScore = source.MaximumScore
            , target.MinimumScore = source.MinimumScore
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Attributes
                , MaximumScore
                , MinimumScore
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.OldEthnicityDescriptor AS target
        USING EdFi_Ods_2021.edfi.OldEthnicityDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OldEthnicityDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , OldEthnicityDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , OldEthnicityDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.OpenStaffPosition AS target
        USING EdFi_Ods_2021.edfi.OpenStaffPosition AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.RequisitionNumber
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DatePosted = source.DatePosted
            , target.DatePostingRemoved = source.DatePostingRemoved
            , target.PositionTitle = source.PositionTitle
                -- References
            , target.EmploymentStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                )
            , target.PostingResultDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostingResultDescriptorId)
                )
            , target.ProgramAssignmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                )
            , target.StaffClassificationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , RequisitionNumber
                -- Identifying references
                , EducationOrganizationHashKey
                -- Attributes
                , DatePosted
                , DatePostingRemoved
                , PositionTitle
                -- References
                , EmploymentStatusDescriptorHashKey
                , PostingResultDescriptorHashKey
                , ProgramAssignmentDescriptorHashKey
                , StaffClassificationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.RequisitionNumber
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , RequisitionNumber
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                -- Attributes
                , DatePosted
                , DatePostingRemoved
                , PositionTitle
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostingResultDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.OpenStaffPositionAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.OpenStaffPositionAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.RequisitionNumber
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.RequisitionNumber
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.OpenStaffPositionInstructionalGradeLevel AS target
        USING EdFi_Ods_2021.edfi.OpenStaffPositionInstructionalGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.RequisitionNumber
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.RequisitionNumber
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.OperationalStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.OperationalStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OperationalStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , OperationalStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OperationalStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , OperationalStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OperationalStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.OtherNameTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.OtherNameTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , OtherNameTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , OtherNameTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Parent AS target
        USING EdFi_Ods_2021.edfi.Parent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.LastSurname = source.LastSurname
            , target.LoginId = source.LoginId
            , target.MaidenName = source.MaidenName
            , target.MiddleName = source.MiddleName
            , target.ParentUniqueId = source.ParentUniqueId
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
                -- References
            , target.PersonHashKey = HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
            , target.SexDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ParentUSI
                -- Identifying references
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , LoginId
                , MaidenName
                , MiddleName
                , ParentUniqueId
                , PersonalTitlePrefix
                -- References
                , PersonHashKey
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , ParentUSI
                -- Identifying references
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , LoginId
                , MaidenName
                , MiddleName
                , ParentUniqueId
                , PersonalTitlePrefix
                -- References
                , HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ParentAddress AS target
        USING EdFi_Ods_2021.edfi.ParentAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
            AND target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            -- Contextual primary key
            AND target.City = source.City
            AND target.PostalCode = source.PostalCode
            AND target.StreetNumberName = source.StreetNumberName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ApartmentRoomSuiteNumber = source.ApartmentRoomSuiteNumber
            , target.BuildingSiteNumber = source.BuildingSiteNumber
            , target.CongressionalDistrict = source.CongressionalDistrict
            , target.CountyFIPSCode = source.CountyFIPSCode
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
            , target.NameOfCounty = source.NameOfCounty
                -- References
            , target.LocaleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                , StateAbbreviationDescriptorHashKey
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , LocaleDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentAddressPeriod AS target
        USING EdFi_Ods_2021.edfi.ParentAddressPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     source.City
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
        + '|' +     source.PostalCode
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
        + '|' +     source.StreetNumberName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     source.City
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                + '|' +     source.PostalCode
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                + '|' +     source.StreetNumberName
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentElectronicMail AS target
        USING EdFi_Ods_2021.edfi.ParentElectronicMail AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ElectronicMailTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.ElectronicMailAddress = source.ElectronicMailAddress
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.PrimaryEmailAddressIndicator = source.PrimaryEmailAddressIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ElectronicMailTypeDescriptorHashKey
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                )
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentInternationalAddress AS target
        USING EdFi_Ods_2021.edfi.ParentInternationalAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AddressLine1 = source.AddressLine1
            , target.AddressLine2 = source.AddressLine2
            , target.AddressLine3 = source.AddressLine3
            , target.AddressLine4 = source.AddressLine4
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
                -- References
            , target.CountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , CountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentLanguage AS target
        USING EdFi_Ods_2021.edfi.ParentLanguage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentLanguageUse AS target
        USING EdFi_Ods_2021.edfi.ParentLanguageUse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageUseDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageUseDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageUseDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentOtherName AS target
        USING EdFi_Ods_2021.edfi.ParentOtherName AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.OtherNameTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.LastSurname = source.LastSurname
            , target.MiddleName = source.MiddleName
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , OtherNameTypeDescriptorHashKey
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                )
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentPersonalIdentificationDocument AS target
        USING EdFi_Ods_2021.edfi.ParentPersonalIdentificationDocument AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ParentUSI)
        + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IdentificationDocumentUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.PersonalInformationVerificationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DocumentExpirationDate = source.DocumentExpirationDate
            , target.DocumentTitle = source.DocumentTitle
            , target.IssuerDocumentIdentificationCode = source.IssuerDocumentIdentificationCode
            , target.IssuerName = source.IssuerName
                -- References
            , target.IssuerCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IdentificationDocumentUseDescriptorHashKey
                , PersonalInformationVerificationDescriptorHashKey
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , IssuerCountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ParentUSI)
                + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParentTelephone AS target
        USING EdFi_Ods_2021.edfi.ParentTelephone AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ParentUSI)
        + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TelephoneNumberTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.TelephoneNumber = source.TelephoneNumber
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.OrderOfPriority = source.OrderOfPriority
            , target.TextMessageCapabilityIndicator = source.TextMessageCapabilityIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TelephoneNumberTypeDescriptorHashKey
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ParticipationDescriptor AS target
        USING EdFi_Ods_2021.edfi.ParticipationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ParticipationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ParticipationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ParticipationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ParticipationStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.ParticipationStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ParticipationStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ParticipationStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ParticipationStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Payroll AS target
        USING EdFi_Ods_2021.edfi.Payroll AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AccountIdentifier
        + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.FiscalYear)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AmountToDate = source.AmountToDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                , StaffUSI
                -- Identifying references
                , AccountHashKey
                , StaffHashKey
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.AsOfDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AccountIdentifier
                , AsOfDate
                , EducationOrganizationId
                , FiscalYear
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AccountIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.FiscalYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , AmountToDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.PerformanceBaseConversionDescriptor AS target
        USING EdFi_Ods_2021.edfi.PerformanceBaseConversionDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PerformanceBaseConversionDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PerformanceBaseConversionDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceBaseConversionDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PerformanceLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.PerformanceLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PerformanceLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PerformanceLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Person AS target
        USING EdFi_Ods_2021.edfi.Person AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.PersonId
        + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PersonId
                , SourceSystemDescriptorId
                -- Identifying references
                , SourceSystemDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PersonId
                , SourceSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.PersonalInformationVerificationDescriptor AS target
        USING EdFi_Ods_2021.edfi.PersonalInformationVerificationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PersonalInformationVerificationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PersonalInformationVerificationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PlatformTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.PlatformTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PlatformTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PlatformTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PlatformTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PopulationServedDescriptor AS target
        USING EdFi_Ods_2021.edfi.PopulationServedDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PopulationServedDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PopulationServedDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PostingResultDescriptor AS target
        USING EdFi_Ods_2021.edfi.PostingResultDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PostingResultDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PostingResultDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostingResultDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PostingResultDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostingResultDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PostSecondaryEvent AS target
        USING EdFi_Ods_2021.edfi.PostSecondaryEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
                -- References
            , target.PostSecondaryInstitutionHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EventDate
                , PostSecondaryEventCategoryDescriptorId
                , StudentUSI
                -- Identifying references
                , PostSecondaryEventCategoryDescriptorHashKey
                , StudentHashKey
                -- References
                , PostSecondaryInstitutionHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EventDate
                , PostSecondaryEventCategoryDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.PostSecondaryEventCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.PostSecondaryEventCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PostSecondaryEventCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PostSecondaryEventCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryEventCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PostSecondaryInstitution AS target
        USING EdFi_Ods_2021.edfi.PostSecondaryInstitution AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PostSecondaryInstitutionId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.AdministrativeFundingControlDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
            , target.PostSecondaryInstitutionLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PostSecondaryInstitutionId
                -- Identifying references
                , EducationOrganizationHashKey
                -- References
                , AdministrativeFundingControlDescriptorHashKey
                , PostSecondaryInstitutionLevelDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PostSecondaryInstitutionId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionId)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PostSecondaryInstitutionMediumOfInstruction AS target
        USING EdFi_Ods_2021.edfi.PostSecondaryInstitutionMediumOfInstruction AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PostSecondaryInstitutionId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.MediumOfInstructionDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , MediumOfInstructionDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PostSecondaryInstitutionId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.PostSecondaryInstitutionLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.PostSecondaryInstitutionLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PostSecondaryInstitutionLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PostSecondaryInstitutionLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PostSecondaryInstitutionLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PostSecondaryInstitutionLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProficiencyDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProficiencyDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProficiencyDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProficiencyDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProficiencyDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProficiencyDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProficiencyDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Program AS target
        USING EdFi_Ods_2021.edfi.Program AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ProgramId = source.ProgramId
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                -- Identifying references
                , EducationOrganizationHashKey
                , ProgramTypeDescriptorHashKey
                -- Attributes
                , ProgramId
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Attributes
                , ProgramId
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ProgramCharacteristic AS target
        USING EdFi_Ods_2021.edfi.ProgramCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ProgramLearningObjective AS target
        USING EdFi_Ods_2021.edfi.ProgramLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningObjectiveHashKey = HASHBYTES('sha1',
                source.LearningObjectiveId
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ProgramLearningStandard AS target
        USING EdFi_Ods_2021.edfi.ProgramLearningStandard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LearningStandardId
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LearningStandardHashKey = HASHBYTES('sha1',
                source.LearningStandardId
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LearningStandardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LearningStandardId
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LearningStandardId
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ProgramService AS target
        USING EdFi_Ods_2021.edfi.ProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ServiceDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ServiceDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ProgramSponsor AS target
        USING EdFi_Ods_2021.edfi.ProgramSponsor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramSponsorDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramSponsorDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ProgramAssignmentDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgramAssignmentDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgramAssignmentDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgramAssignmentDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProgramCharacteristicDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgramCharacteristicDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgramCharacteristicDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgramCharacteristicDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProgramSponsorDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgramSponsorDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgramSponsorDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgramSponsorDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramSponsorDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProgramTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgramTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgramTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgramTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProgressDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgressDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgressDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgressDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgressDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProgressLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProgressLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgressLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgressLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgressLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProviderCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProviderCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProviderCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProviderCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProviderCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProviderProfitabilityDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProviderProfitabilityDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProviderProfitabilityDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProviderProfitabilityDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderProfitabilityDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProviderProfitabilityDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderProfitabilityDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ProviderStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.ProviderStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProviderStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProviderStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProviderStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProviderStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.PublicationStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.PublicationStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.PublicationStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , PublicationStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , PublicationStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PublicationStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.QuestionFormDescriptor AS target
        USING EdFi_Ods_2021.edfi.QuestionFormDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.QuestionFormDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , QuestionFormDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.QuestionFormDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , QuestionFormDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.QuestionFormDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RaceDescriptor AS target
        USING EdFi_Ods_2021.edfi.RaceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RaceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RaceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RaceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RaceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RaceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ReasonExitedDescriptor AS target
        USING EdFi_Ods_2021.edfi.ReasonExitedDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ReasonExitedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ReasonExitedDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonExitedDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ReasonExitedDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonExitedDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ReasonNotTestedDescriptor AS target
        USING EdFi_Ods_2021.edfi.ReasonNotTestedDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ReasonNotTestedDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ReasonNotTestedDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonNotTestedDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ReasonNotTestedDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonNotTestedDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RecognitionTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.RecognitionTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RecognitionTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RecognitionTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RelationDescriptor AS target
        USING EdFi_Ods_2021.edfi.RelationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RelationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RelationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RelationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RelationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RelationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RepeatIdentifierDescriptor AS target
        USING EdFi_Ods_2021.edfi.RepeatIdentifierDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RepeatIdentifierDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RepeatIdentifierDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RepeatIdentifierDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RepeatIdentifierDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RepeatIdentifierDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ReportCard AS target
        USING EdFi_Ods_2021.edfi.ReportCard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.GPACumulative = source.GPACumulative
            , target.GPAGivenGradingPeriod = source.GPAGivenGradingPeriod
            , target.NumberOfDaysAbsent = source.NumberOfDaysAbsent
            , target.NumberOfDaysInAttendance = source.NumberOfDaysInAttendance
            , target.NumberOfDaysTardy = source.NumberOfDaysTardy
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , StudentUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , GradingPeriodHashKey
                , StudentHashKey
                -- Attributes
                , GPACumulative
                , GPAGivenGradingPeriod
                , NumberOfDaysAbsent
                , NumberOfDaysInAttendance
                , NumberOfDaysTardy
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , GPACumulative
                , GPAGivenGradingPeriod
                , NumberOfDaysAbsent
                , NumberOfDaysInAttendance
                , NumberOfDaysTardy
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.ReportCardGrade AS target
        USING EdFi_Ods_2021.edfi.ReportCardGrade AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BeginDate, 23)
            + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
            + '|' +     source.LocalCourseCode
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            + '|' +     source.SectionIdentifier
            + '|' +     source.SessionName
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.GradeTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ReportCardGradePointAverage AS target
        USING EdFi_Ods_2021.edfi.ReportCardGradePointAverage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradePointAverageTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.GradePointAverageValue = source.GradePointAverageValue
            , target.IsCumulative = source.IsCumulative
            , target.MaxGradePointAverageValue = source.MaxGradePointAverageValue
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradePointAverageTypeDescriptorHashKey
                -- Attributes
                , GradePointAverageValue
                , IsCumulative
                , MaxGradePointAverageValue
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                )
                -- Attributes
                , GradePointAverageValue
                , IsCumulative
                , MaxGradePointAverageValue
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ReportCardStudentCompetencyObjective AS target
        USING EdFi_Ods_2021.edfi.ReportCardStudentCompetencyObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.Objective
        + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentCompetencyObjectiveHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
            + '|' +     source.Objective
            + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentCompetencyObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ReportCardStudentLearningObjective AS target
        USING EdFi_Ods_2021.edfi.ReportCardStudentLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentLearningObjectiveHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
            + '|' +     source.LearningObjectiveId
            + '|' +     source.Namespace
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentLearningObjectiveHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.ReporterDescriptionDescriptor AS target
        USING EdFi_Ods_2021.edfi.ReporterDescriptionDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ReporterDescriptionDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ReporterDescriptionDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReporterDescriptionDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ReporterDescriptionDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReporterDescriptionDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ResidencyStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.ResidencyStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ResidencyStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ResidencyStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResidencyStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ResidencyStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResidencyStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ResponseIndicatorDescriptor AS target
        USING EdFi_Ods_2021.edfi.ResponseIndicatorDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ResponseIndicatorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ResponseIndicatorDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponseIndicatorDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ResponseIndicatorDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponseIndicatorDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ResponsibilityDescriptor AS target
        USING EdFi_Ods_2021.edfi.ResponsibilityDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ResponsibilityDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ResponsibilityDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponsibilityDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ResponsibilityDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponsibilityDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RestraintEvent AS target
        USING EdFi_Ods_2021.edfi.RestraintEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.RestraintEventIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EventDate = source.EventDate
                -- References
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RestraintEventIdentifier
                , SchoolId
                , StudentUSI
                -- Identifying references
                , SchoolHashKey
                , StudentHashKey
                -- Attributes
                , EventDate
                -- References
                , EducationalEnvironmentDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.RestraintEventIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , RestraintEventIdentifier
                , SchoolId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EventDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.RestraintEventProgram AS target
        USING EdFi_Ods_2021.edfi.RestraintEventProgram AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     source.RestraintEventIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     source.RestraintEventIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.RestraintEventReason AS target
        USING EdFi_Ods_2021.edfi.RestraintEventReason AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.RestraintEventIdentifier
        + '|' +     CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.RestraintEventReasonDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , RestraintEventReasonDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.RestraintEventIdentifier
                + '|' +     CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.RestraintEventReasonDescriptor AS target
        USING EdFi_Ods_2021.edfi.RestraintEventReasonDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RestraintEventReasonDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RestraintEventReasonDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RestraintEventReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ResultDatatypeTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.ResultDatatypeTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ResultDatatypeTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ResultDatatypeTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.RetestIndicatorDescriptor AS target
        USING EdFi_Ods_2021.edfi.RetestIndicatorDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RetestIndicatorDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , RetestIndicatorDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RetestIndicatorDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , RetestIndicatorDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RetestIndicatorDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.School AS target
        USING EdFi_Ods_2021.edfi.School AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.AdministrativeFundingControlDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
            , target.CharterApprovalAgencyTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalAgencyTypeDescriptorId)
                )
            , target.CharterStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
            , target.InternetAccessDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InternetAccessDescriptorId)
                )
            , target.LocalEducationAgencyHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                )
            , target.MagnetSpecialProgramEmphasisSchoolDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MagnetSpecialProgramEmphasisSchoolDescriptorId)
                )
            , target.SchoolTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolTypeDescriptorId)
                )
            , target.CharterApprovalSchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalSchoolYear)
                )
            , target.TitleIPartASchoolDesignationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartASchoolDesignationDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolId
                -- Identifying references
                , EducationOrganizationHashKey
                -- References
                , AdministrativeFundingControlDescriptorHashKey
                , CharterApprovalAgencyTypeDescriptorHashKey
                , CharterStatusDescriptorHashKey
                , InternetAccessDescriptorHashKey
                , LocalEducationAgencyHashKey
                , MagnetSpecialProgramEmphasisSchoolDescriptorHashKey
                , SchoolTypeDescriptorHashKey
                , CharterApprovalSchoolYearTypeHashKey
                , TitleIPartASchoolDesignationDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrativeFundingControlDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalAgencyTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InternetAccessDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocalEducationAgencyId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MagnetSpecialProgramEmphasisSchoolDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CharterApprovalSchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartASchoolDesignationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SchoolCategory AS target
        USING EdFi_Ods_2021.edfi.SchoolCategory AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SchoolCategoryDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SchoolCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SchoolGradeLevel AS target
        USING EdFi_Ods_2021.edfi.SchoolGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SchoolCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.SchoolCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SchoolChoiceImplementStatusDescriptor AS target
        USING EdFi_Ods_2021.edfi.SchoolChoiceImplementStatusDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolChoiceImplementStatusDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolChoiceImplementStatusDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolChoiceImplementStatusDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolChoiceImplementStatusDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolChoiceImplementStatusDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SchoolFoodServiceProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.SchoolFoodServiceProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolFoodServiceProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolFoodServiceProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SchoolTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.SchoolTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SchoolYearType AS target
        USING EdFi_Ods_2021.edfi.SchoolYearType AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolYear)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CurrentSchoolYear = source.CurrentSchoolYear
            , target.SchoolYearDescription = source.SchoolYearDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolYear
                -- Identifying references
                -- Attributes
                , CurrentSchoolYear
                , SchoolYearDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolYear
                -- Identifying references
                -- Attributes
                , CurrentSchoolYear
                , SchoolYearDescription
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.Section AS target
        USING EdFi_Ods_2021.edfi.Section AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AvailableCreditConversion = source.AvailableCreditConversion
            , target.AvailableCredits = source.AvailableCredits
            , target.OfficialAttendancePeriod = source.OfficialAttendancePeriod
            , target.SectionName = source.SectionName
            , target.SequenceOfCourse = source.SequenceOfCourse
                -- References
            , target.AvailableCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AvailableCreditTypeDescriptorId)
                )
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
            , target.InstructionLanguageDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InstructionLanguageDescriptorId)
                )
            , target.LocationHashKey = HASHBYTES('sha1', 
                    source.LocationClassroomIdentificationCode
                + '|' +     CONVERT(nvarchar, source.LocationSchoolId)
                )
            , target.MediumOfInstructionDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                )
            , target.PopulationServedDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
            , target.LocationSchoolHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocationSchoolId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , CourseOfferingHashKey
                -- Attributes
                , AvailableCreditConversion
                , AvailableCredits
                , OfficialAttendancePeriod
                , SectionName
                , SequenceOfCourse
                -- References
                , AvailableCreditTypeDescriptorHashKey
                , EducationalEnvironmentDescriptorHashKey
                , InstructionLanguageDescriptorHashKey
                , LocationHashKey
                , MediumOfInstructionDescriptorHashKey
                , PopulationServedDescriptorHashKey
                , LocationSchoolHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                -- Attributes
                , AvailableCreditConversion
                , AvailableCredits
                , OfficialAttendancePeriod
                , SectionName
                , SequenceOfCourse
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AvailableCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InstructionLanguageDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.LocationClassroomIdentificationCode
                + '|' +     CONVERT(nvarchar, source.LocationSchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MediumOfInstructionDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocationSchoolId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SectionCharacteristic AS target
        USING EdFi_Ods_2021.edfi.SectionCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SectionCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SectionCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SectionClassPeriod AS target
        USING EdFi_Ods_2021.edfi.SectionClassPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ClassPeriodName
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ClassPeriodHashKey = HASHBYTES('sha1',
                source.ClassPeriodName
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ClassPeriodHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ClassPeriodName
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.ClassPeriodName
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SectionCourseLevelCharacteristic AS target
        USING EdFi_Ods_2021.edfi.SectionCourseLevelCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CourseLevelCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CourseLevelCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CourseLevelCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SectionOfferedGradeLevel AS target
        USING EdFi_Ods_2021.edfi.SectionOfferedGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SectionProgram AS target
        USING EdFi_Ods_2021.edfi.SectionProgram AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LocalCourseCode
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LocalCourseCode
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SectionAttendanceTakenEvent AS target
        USING EdFi_Ods_2021.edfi.SectionAttendanceTakenEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CalendarCode
        + '|' +     CONVERT(nvarchar, source.Date, 23)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EventDate = source.EventDate
                -- References
            , target.StaffHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CalendarCode
                , Date
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , CalendarDateHashKey
                , SectionHashKey
                -- Attributes
                , EventDate
                -- References
                , StaffHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.Date, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Primary key columns
                , CalendarCode
                , Date
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.Date, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                -- Attributes
                , EventDate
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SectionCharacteristicDescriptor AS target
        USING EdFi_Ods_2021.edfi.SectionCharacteristicDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SectionCharacteristicDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SectionCharacteristicDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SectionCharacteristicDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SeparationDescriptor AS target
        USING EdFi_Ods_2021.edfi.SeparationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SeparationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SeparationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SeparationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SeparationReasonDescriptor AS target
        USING EdFi_Ods_2021.edfi.SeparationReasonDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SeparationReasonDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SeparationReasonDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationReasonDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SeparationReasonDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.ServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.ServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , ServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Session AS target
        USING EdFi_Ods_2021.edfi.Session AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.TotalInstructionalDays = source.TotalInstructionalDays
                -- References
            , target.TermDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TermDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SchoolId
                , SchoolYear
                , SessionName
                -- Identifying references
                , SchoolHashKey
                , SchoolYearTypeHashKey
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- References
                , TermDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Primary key columns
                , SchoolId
                , SchoolYear
                , SessionName
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Attributes
                , BeginDate
                , EndDate
                , TotalInstructionalDays
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TermDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SessionAcademicWeek AS target
        USING EdFi_Ods_2021.edfi.SessionAcademicWeek AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
        + '|' +     source.WeekIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicWeekHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolId)
            + '|' +     source.WeekIdentifier
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicWeekHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                + '|' +     source.WeekIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     source.WeekIdentifier
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SessionGradingPeriod AS target
        USING EdFi_Ods_2021.edfi.SessionGradingPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PeriodSequence)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradingPeriodHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            + '|' +     CONVERT(nvarchar, source.PeriodSequence)
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradingPeriodHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SexDescriptor AS target
        USING EdFi_Ods_2021.edfi.SexDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SexDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SexDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SexDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SourceSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.SourceSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SourceSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SourceSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SourceSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SpecialEducationProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.SpecialEducationProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SpecialEducationProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SpecialEducationProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SpecialEducationSettingDescriptor AS target
        USING EdFi_Ods_2021.edfi.SpecialEducationSettingDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SpecialEducationSettingDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SpecialEducationSettingDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationSettingDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SpecialEducationSettingDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationSettingDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.Staff AS target
        USING EdFi_Ods_2021.edfi.Staff AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BirthDate = source.BirthDate
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.HighlyQualifiedTeacher = source.HighlyQualifiedTeacher
            , target.HispanicLatinoEthnicity = source.HispanicLatinoEthnicity
            , target.LastSurname = source.LastSurname
            , target.LoginId = source.LoginId
            , target.MaidenName = source.MaidenName
            , target.MiddleName = source.MiddleName
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
            , target.StaffUniqueId = source.StaffUniqueId
            , target.YearsOfPriorProfessionalExperience = source.YearsOfPriorProfessionalExperience
            , target.YearsOfPriorTeachingExperience = source.YearsOfPriorTeachingExperience
                -- References
            , target.CitizenshipStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
            , target.HighestCompletedLevelOfEducationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HighestCompletedLevelOfEducationDescriptorId)
                )
            , target.OldEthnicityDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
            , target.PersonHashKey = HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
            , target.SexDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StaffUSI
                -- Identifying references
                -- Attributes
                , BirthDate
                , FirstName
                , GenerationCodeSuffix
                , HighlyQualifiedTeacher
                , HispanicLatinoEthnicity
                , LastSurname
                , LoginId
                , MaidenName
                , MiddleName
                , PersonalTitlePrefix
                , StaffUniqueId
                , YearsOfPriorProfessionalExperience
                , YearsOfPriorTeachingExperience
                -- References
                , CitizenshipStatusDescriptorHashKey
                , HighestCompletedLevelOfEducationDescriptorHashKey
                , OldEthnicityDescriptorHashKey
                , PersonHashKey
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , StaffUSI
                -- Identifying references
                -- Attributes
                , BirthDate
                , FirstName
                , GenerationCodeSuffix
                , HighlyQualifiedTeacher
                , HispanicLatinoEthnicity
                , LastSurname
                , LoginId
                , MaidenName
                , MiddleName
                , PersonalTitlePrefix
                , StaffUniqueId
                , YearsOfPriorProfessionalExperience
                , YearsOfPriorTeachingExperience
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HighestCompletedLevelOfEducationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffAddress AS target
        USING EdFi_Ods_2021.edfi.StaffAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
            AND target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            -- Contextual primary key
            AND target.City = source.City
            AND target.PostalCode = source.PostalCode
            AND target.StreetNumberName = source.StreetNumberName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ApartmentRoomSuiteNumber = source.ApartmentRoomSuiteNumber
            , target.BuildingSiteNumber = source.BuildingSiteNumber
            , target.CongressionalDistrict = source.CongressionalDistrict
            , target.CountyFIPSCode = source.CountyFIPSCode
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
            , target.NameOfCounty = source.NameOfCounty
                -- References
            , target.LocaleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                , StateAbbreviationDescriptorHashKey
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , LocaleDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffAddressPeriod AS target
        USING EdFi_Ods_2021.edfi.StaffAddressPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     source.City
        + '|' +     source.PostalCode
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
        + '|' +     source.StreetNumberName
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     source.City
                + '|' +     source.PostalCode
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                + '|' +     source.StreetNumberName
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffCredential AS target
        USING EdFi_Ods_2021.edfi.StaffCredential AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CredentialIdentifier
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CredentialHashKey = HASHBYTES('sha1',
                source.CredentialIdentifier
            + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CredentialHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffElectronicMail AS target
        USING EdFi_Ods_2021.edfi.StaffElectronicMail AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ElectronicMailTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.ElectronicMailAddress = source.ElectronicMailAddress
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.PrimaryEmailAddressIndicator = source.PrimaryEmailAddressIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ElectronicMailTypeDescriptorHashKey
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                )
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.StaffIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StaffIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StaffIdentificationSystemDescriptorHashKey
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
                )
                -- Attributes
                , AssigningOrganizationIdentificationCode
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffIdentificationDocument AS target
        USING EdFi_Ods_2021.edfi.StaffIdentificationDocument AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IdentificationDocumentUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.PersonalInformationVerificationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DocumentExpirationDate = source.DocumentExpirationDate
            , target.DocumentTitle = source.DocumentTitle
            , target.IssuerDocumentIdentificationCode = source.IssuerDocumentIdentificationCode
            , target.IssuerName = source.IssuerName
                -- References
            , target.IssuerCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IdentificationDocumentUseDescriptorHashKey
                , PersonalInformationVerificationDescriptorHashKey
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , IssuerCountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffInternationalAddress AS target
        USING EdFi_Ods_2021.edfi.StaffInternationalAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AddressLine1 = source.AddressLine1
            , target.AddressLine2 = source.AddressLine2
            , target.AddressLine3 = source.AddressLine3
            , target.AddressLine4 = source.AddressLine4
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
                -- References
            , target.CountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , CountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffLanguage AS target
        USING EdFi_Ods_2021.edfi.StaffLanguage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffLanguageUse AS target
        USING EdFi_Ods_2021.edfi.StaffLanguageUse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageUseDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageUseDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageUseDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffOtherName AS target
        USING EdFi_Ods_2021.edfi.StaffOtherName AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.OtherNameTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.LastSurname = source.LastSurname
            , target.MiddleName = source.MiddleName
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , OtherNameTypeDescriptorHashKey
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                )
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffPersonalIdentificationDocument AS target
        USING EdFi_Ods_2021.edfi.StaffPersonalIdentificationDocument AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IdentificationDocumentUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.PersonalInformationVerificationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DocumentExpirationDate = source.DocumentExpirationDate
            , target.DocumentTitle = source.DocumentTitle
            , target.IssuerDocumentIdentificationCode = source.IssuerDocumentIdentificationCode
            , target.IssuerName = source.IssuerName
                -- References
            , target.IssuerCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IdentificationDocumentUseDescriptorHashKey
                , PersonalInformationVerificationDescriptorHashKey
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , IssuerCountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffRace AS target
        USING EdFi_Ods_2021.edfi.StaffRace AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RaceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.RaceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.RaceDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , RaceDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RaceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RaceDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffRecognition AS target
        USING EdFi_Ods_2021.edfi.StaffRecognition AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.RecognitionTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AchievementCategorySystem = source.AchievementCategorySystem
            , target.AchievementTitle = source.AchievementTitle
            , target.Criteria = source.Criteria
            , target.CriteriaURL = source.CriteriaURL
            , target.EvidenceStatement = source.EvidenceStatement
            , target.ImageURL = source.ImageURL
            , target.IssuerName = source.IssuerName
            , target.IssuerOriginURL = source.IssuerOriginURL
            , target.RecognitionAwardDate = source.RecognitionAwardDate
            , target.RecognitionAwardExpiresDate = source.RecognitionAwardExpiresDate
            , target.RecognitionDescription = source.RecognitionDescription
                -- References
            , target.AchievementCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , RecognitionTypeDescriptorHashKey
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                , RecognitionAwardDate
                , RecognitionAwardExpiresDate
                , RecognitionDescription
                -- References
                , AchievementCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                )
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                , RecognitionAwardDate
                , RecognitionAwardExpiresDate
                , RecognitionDescription
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffTelephone AS target
        USING EdFi_Ods_2021.edfi.StaffTelephone AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TelephoneNumberTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.TelephoneNumber = source.TelephoneNumber
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.OrderOfPriority = source.OrderOfPriority
            , target.TextMessageCapabilityIndicator = source.TextMessageCapabilityIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TelephoneNumberTypeDescriptorHashKey
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffTribalAffiliation AS target
        USING EdFi_Ods_2021.edfi.StaffTribalAffiliation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TribalAffiliationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TribalAffiliationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffVisa AS target
        USING EdFi_Ods_2021.edfi.StaffVisa AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.VisaDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.VisaDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.VisaDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , VisaDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.VisaDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.VisaDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffAbsenceEvent AS target
        USING EdFi_Ods_2021.edfi.StaffAbsenceEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AbsenceEventReason = source.AbsenceEventReason
            , target.HoursAbsent = source.HoursAbsent
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AbsenceEventCategoryDescriptorId
                , EventDate
                , StaffUSI
                -- Identifying references
                , AbsenceEventCategoryDescriptorHashKey
                , StaffHashKey
                -- Attributes
                , AbsenceEventReason
                , HoursAbsent
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AbsenceEventCategoryDescriptorId
                , EventDate
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AbsenceEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , AbsenceEventReason
                , HoursAbsent
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffClassificationDescriptor AS target
        USING EdFi_Ods_2021.edfi.StaffClassificationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffClassificationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StaffClassificationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StaffClassificationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StaffCohortAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffCohortAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     source.CohortIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.StudentRecordAccess = source.StudentRecordAccess
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , CohortIdentifier
                , EducationOrganizationId
                , StaffUSI
                -- Identifying references
                , CohortHashKey
                , StaffHashKey
                -- Attributes
                , EndDate
                , StudentRecordAccess
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , CohortIdentifier
                , EducationOrganizationId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , EndDate
                , StudentRecordAccess
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffDisciplineIncidentAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffDisciplineIncidentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                , StaffUSI
                -- Identifying references
                , DisciplineIncidentHashKey
                , StaffHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffDisciplineIncidentAssociationDisciplineIncidentParticipationCode AS target
        USING EdFi_Ods_2021.edfi.StaffDisciplineIncidentAssociationDisciplineIncidentParticipationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
        + '|' +     source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisciplineIncidentParticipationCodeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisciplineIncidentParticipationCodeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                + '|' +     source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisciplineIncidentParticipationCodeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffEducationOrganizationAssignmentAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationAssignmentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffClassificationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.OrderOfAssignment = source.OrderOfAssignment
            , target.PositionTitle = source.PositionTitle
                -- References
            , target.CredentialHashKey = HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
            , target.EmploymentStaffEducationOrganizationEmploymentAssociationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EmploymentHireDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , StaffClassificationDescriptorId
                , StaffUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , StaffHashKey
                , StaffClassificationDescriptorHashKey
                -- Attributes
                , EndDate
                , OrderOfAssignment
                , PositionTitle
                -- References
                , CredentialHashKey
                , EmploymentStaffEducationOrganizationEmploymentAssociationHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , StaffClassificationDescriptorId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffClassificationDescriptorId)
                )
                -- Attributes
                , EndDate
                , OrderOfAssignment
                , PositionTitle
                -- References
                , HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EmploymentHireDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffEducationOrganizationContactAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationContactAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContactTitle
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ElectronicMailAddress = source.ElectronicMailAddress
                -- References
            , target.ContactTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContactTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ContactTitle
                , EducationOrganizationId
                , StaffUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , StaffHashKey
                -- Attributes
                , ElectronicMailAddress
                -- References
                , ContactTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContactTitle
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , ContactTitle
                , EducationOrganizationId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , ElectronicMailAddress
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContactTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffEducationOrganizationContactAssociationAddress AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationContactAssociationAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContactTitle
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ApartmentRoomSuiteNumber = source.ApartmentRoomSuiteNumber
            , target.BuildingSiteNumber = source.BuildingSiteNumber
            , target.City = source.City
            , target.CongressionalDistrict = source.CongressionalDistrict
            , target.CountyFIPSCode = source.CountyFIPSCode
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
            , target.NameOfCounty = source.NameOfCounty
            , target.PostalCode = source.PostalCode
            , target.StreetNumberName = source.StreetNumberName
                -- References
            , target.AddressTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
            , target.LocaleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
            , target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , City
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                , PostalCode
                , StreetNumberName
                -- References
                , AddressTypeDescriptorHashKey
                , LocaleDescriptorHashKey
                , StateAbbreviationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContactTitle
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , City
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                , PostalCode
                , StreetNumberName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffEducationOrganizationContactAssociationAddressPeriod AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationContactAssociationAddressPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContactTitle
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContactTitle
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffEducationOrganizationContactAssociationTelephone AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationContactAssociationTelephone AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.ContactTitle
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TelephoneNumberTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.TelephoneNumber = source.TelephoneNumber
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.OrderOfPriority = source.OrderOfPriority
            , target.TextMessageCapabilityIndicator = source.TextMessageCapabilityIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TelephoneNumberTypeDescriptorHashKey
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.ContactTitle
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffEducationOrganizationEmploymentAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffEducationOrganizationEmploymentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
        + '|' +     CONVERT(nvarchar, source.HireDate, 23)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Department = source.Department
            , target.EndDate = source.EndDate
            , target.FullTimeEquivalency = source.FullTimeEquivalency
            , target.HourlyWage = source.HourlyWage
            , target.OfferDate = source.OfferDate
                -- References
            , target.CredentialHashKey = HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
            , target.SeparationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationDescriptorId)
                )
            , target.SeparationReasonDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationReasonDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , EmploymentStatusDescriptorId
                , HireDate
                , StaffUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , EmploymentStatusDescriptorHashKey
                , StaffHashKey
                -- Attributes
                , Department
                , EndDate
                , FullTimeEquivalency
                , HourlyWage
                , OfferDate
                -- References
                , CredentialHashKey
                , SeparationDescriptorHashKey
                , SeparationReasonDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                + '|' +     CONVERT(nvarchar, source.HireDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , EmploymentStatusDescriptorId
                , HireDate
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EmploymentStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , Department
                , EndDate
                , FullTimeEquivalency
                , HourlyWage
                , OfferDate
                -- References
                , HASHBYTES('sha1', 
                    source.CredentialIdentifier
                + '|' +     CONVERT(nvarchar, source.StateOfIssueStateAbbreviationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SeparationReasonDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffIdentificationSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.StaffIdentificationSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StaffIdentificationSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StaffIdentificationSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffIdentificationSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StaffLeave AS target
        USING EdFi_Ods_2021.edfi.StaffLeave AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.Reason = source.Reason
            , target.SubstituteAssigned = source.SubstituteAssigned
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , StaffLeaveEventCategoryDescriptorId
                , StaffUSI
                -- Identifying references
                , StaffHashKey
                , StaffLeaveEventCategoryDescriptorHashKey
                -- Attributes
                , EndDate
                , Reason
                , SubstituteAssigned
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , StaffLeaveEventCategoryDescriptorId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
                )
                -- Attributes
                , EndDate
                , Reason
                , SubstituteAssigned
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffLeaveEventCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.StaffLeaveEventCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StaffLeaveEventCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StaffLeaveEventCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffLeaveEventCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StaffProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.StudentRecordAccess = source.StudentRecordAccess
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StaffUSI
                -- Identifying references
                , ProgramHashKey
                , StaffHashKey
                -- Attributes
                , EndDate
                , StudentRecordAccess
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , EndDate
                , StudentRecordAccess
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffSchoolAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffSchoolAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
                -- References
            , target.CalendarHashKey = HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
            , target.SchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ProgramAssignmentDescriptorId
                , SchoolId
                , StaffUSI
                -- Identifying references
                , ProgramAssignmentDescriptorHashKey
                , SchoolHashKey
                , StaffHashKey
                -- References
                , CalendarHashKey
                , SchoolYearTypeHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , ProgramAssignmentDescriptorId
                , SchoolId
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- References
                , HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StaffSchoolAssociationAcademicSubject AS target
        USING EdFi_Ods_2021.edfi.StaffSchoolAssociationAcademicSubject AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicSubjectDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicSubjectDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicSubjectDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffSchoolAssociationGradeLevel AS target
        USING EdFi_Ods_2021.edfi.StaffSchoolAssociationGradeLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradeLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramAssignmentDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StaffSectionAssociation AS target
        USING EdFi_Ods_2021.edfi.StaffSectionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.HighlyQualifiedTeacher = source.HighlyQualifiedTeacher
            , target.PercentageContribution = source.PercentageContribution
            , target.TeacherStudentDataLinkExclusion = source.TeacherStudentDataLinkExclusion
                -- References
            , target.ClassroomPositionDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassroomPositionDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StaffUSI
                -- Identifying references
                , SectionHashKey
                , StaffHashKey
                -- Attributes
                , BeginDate
                , EndDate
                , HighlyQualifiedTeacher
                , PercentageContribution
                , TeacherStudentDataLinkExclusion
                -- References
                , ClassroomPositionDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StaffUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , BeginDate
                , EndDate
                , HighlyQualifiedTeacher
                , PercentageContribution
                , TeacherStudentDataLinkExclusion
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassroomPositionDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StateAbbreviationDescriptor AS target
        USING EdFi_Ods_2021.edfi.StateAbbreviationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StateAbbreviationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StateAbbreviationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StateEducationAgency AS target
        USING EdFi_Ods_2021.edfi.StateEducationAgency AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StateEducationAgencyId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StateEducationAgencyId
                -- Identifying references
                , EducationOrganizationHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StateEducationAgencyId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StateEducationAgencyAccountability AS target
        USING EdFi_Ods_2021.edfi.StateEducationAgencyAccountability AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StateEducationAgencyId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SchoolYearTypeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolYear)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CTEGraduationRateInclusion = source.CTEGraduationRateInclusion
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SchoolYearTypeHashKey
                -- Attributes
                , CTEGraduationRateInclusion
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Attributes
                , CTEGraduationRateInclusion
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StateEducationAgencyFederalFunds AS target
        USING EdFi_Ods_2021.edfi.StateEducationAgencyFederalFunds AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StateEducationAgencyId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.FiscalYear = source.FiscalYear
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.FederalProgramsFundingAllocation = source.FederalProgramsFundingAllocation
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , FiscalYear
                -- Attributes
                , FederalProgramsFundingAllocation
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateEducationAgencyId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , FiscalYear
                -- Attributes
                , FederalProgramsFundingAllocation
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.Student AS target
        USING EdFi_Ods_2021.edfi.Student AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.BirthCity = source.BirthCity
            , target.BirthDate = source.BirthDate
            , target.BirthInternationalProvince = source.BirthInternationalProvince
            , target.DateEnteredUS = source.DateEnteredUS
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.LastSurname = source.LastSurname
            , target.MaidenName = source.MaidenName
            , target.MiddleName = source.MiddleName
            , target.MultipleBirthStatus = source.MultipleBirthStatus
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
            , target.StudentUniqueId = source.StudentUniqueId
                -- References
            , target.CitizenshipStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
            , target.BirthCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthCountryDescriptorId)
                )
            , target.PersonHashKey = HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
            , target.BirthSexDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthSexDescriptorId)
                )
            , target.BirthStateAbbreviationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthStateAbbreviationDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StudentUSI
                -- Identifying references
                -- Attributes
                , BirthCity
                , BirthDate
                , BirthInternationalProvince
                , DateEnteredUS
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MaidenName
                , MiddleName
                , MultipleBirthStatus
                , PersonalTitlePrefix
                , StudentUniqueId
                -- References
                , CitizenshipStatusDescriptorHashKey
                , BirthCountryDescriptorHashKey
                , PersonHashKey
                , BirthSexDescriptorHashKey
                , BirthStateAbbreviationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , StudentUSI
                -- Identifying references
                -- Attributes
                , BirthCity
                , BirthDate
                , BirthInternationalProvince
                , DateEnteredUS
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MaidenName
                , MiddleName
                , MultipleBirthStatus
                , PersonalTitlePrefix
                , StudentUniqueId
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CitizenshipStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthCountryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.PersonId
                + '|' +     CONVERT(nvarchar, source.SourceSystemDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthSexDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BirthStateAbbreviationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentIdentificationDocument AS target
        USING EdFi_Ods_2021.edfi.StudentIdentificationDocument AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IdentificationDocumentUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.PersonalInformationVerificationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DocumentExpirationDate = source.DocumentExpirationDate
            , target.DocumentTitle = source.DocumentTitle
            , target.IssuerDocumentIdentificationCode = source.IssuerDocumentIdentificationCode
            , target.IssuerName = source.IssuerName
                -- References
            , target.IssuerCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IdentificationDocumentUseDescriptorHashKey
                , PersonalInformationVerificationDescriptorHashKey
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , IssuerCountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentOtherName AS target
        USING EdFi_Ods_2021.edfi.StudentOtherName AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.OtherNameTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.FirstName = source.FirstName
            , target.GenerationCodeSuffix = source.GenerationCodeSuffix
            , target.LastSurname = source.LastSurname
            , target.MiddleName = source.MiddleName
            , target.PersonalTitlePrefix = source.PersonalTitlePrefix
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , OtherNameTypeDescriptorHashKey
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OtherNameTypeDescriptorId)
                )
                -- Attributes
                , FirstName
                , GenerationCodeSuffix
                , LastSurname
                , MiddleName
                , PersonalTitlePrefix
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentPersonalIdentificationDocument AS target
        USING EdFi_Ods_2021.edfi.StudentPersonalIdentificationDocument AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.IdentificationDocumentUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
            )
            AND target.PersonalInformationVerificationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DocumentExpirationDate = source.DocumentExpirationDate
            , target.DocumentTitle = source.DocumentTitle
            , target.IssuerDocumentIdentificationCode = source.IssuerDocumentIdentificationCode
            , target.IssuerName = source.IssuerName
                -- References
            , target.IssuerCountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , IdentificationDocumentUseDescriptorHashKey
                , PersonalInformationVerificationDescriptorHashKey
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , IssuerCountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IdentificationDocumentUseDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PersonalInformationVerificationDescriptorId)
                )
                -- Attributes
                , DocumentExpirationDate
                , DocumentTitle
                , IssuerDocumentIdentificationCode
                , IssuerName
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.IssuerCountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentVisa AS target
        USING EdFi_Ods_2021.edfi.StudentVisa AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.VisaDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.VisaDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.VisaDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , VisaDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.VisaDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.VisaDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecord AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecord AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.CumulativeAttemptedCreditConversion = source.CumulativeAttemptedCreditConversion
            , target.CumulativeAttemptedCredits = source.CumulativeAttemptedCredits
            , target.CumulativeEarnedCreditConversion = source.CumulativeEarnedCreditConversion
            , target.CumulativeEarnedCredits = source.CumulativeEarnedCredits
            , target.CumulativeGradePointAverage = source.CumulativeGradePointAverage
            , target.CumulativeGradePointsEarned = source.CumulativeGradePointsEarned
            , target.GradeValueQualifier = source.GradeValueQualifier
            , target.ProjectedGraduationDate = source.ProjectedGraduationDate
            , target.SessionAttemptedCreditConversion = source.SessionAttemptedCreditConversion
            , target.SessionAttemptedCredits = source.SessionAttemptedCredits
            , target.SessionEarnedCreditConversion = source.SessionEarnedCreditConversion
            , target.SessionEarnedCredits = source.SessionEarnedCredits
            , target.SessionGradePointAverage = source.SessionGradePointAverage
            , target.SessionGradePointsEarned = source.SessionGradePointsEarned
                -- References
            , target.CumulativeEarnedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CumulativeEarnedCreditTypeDescriptorId)
                )
            , target.CumulativeAttemptedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CumulativeAttemptedCreditTypeDescriptorId)
                )
            , target.SessionEarnedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SessionEarnedCreditTypeDescriptorId)
                )
            , target.SessionAttemptedCreditTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SessionAttemptedCreditTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , SchoolYear
                , StudentUSI
                , TermDescriptorId
                -- Identifying references
                , EducationOrganizationHashKey
                , SchoolYearTypeHashKey
                , StudentHashKey
                , TermDescriptorHashKey
                -- Attributes
                , CumulativeAttemptedCreditConversion
                , CumulativeAttemptedCredits
                , CumulativeEarnedCreditConversion
                , CumulativeEarnedCredits
                , CumulativeGradePointAverage
                , CumulativeGradePointsEarned
                , GradeValueQualifier
                , ProjectedGraduationDate
                , SessionAttemptedCreditConversion
                , SessionAttemptedCredits
                , SessionEarnedCreditConversion
                , SessionEarnedCredits
                , SessionGradePointAverage
                , SessionGradePointsEarned
                -- References
                , CumulativeEarnedCreditTypeDescriptorHashKey
                , CumulativeAttemptedCreditTypeDescriptorHashKey
                , SessionEarnedCreditTypeDescriptorHashKey
                , SessionAttemptedCreditTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , SchoolYear
                , StudentUSI
                , TermDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TermDescriptorId)
                )
                -- Attributes
                , CumulativeAttemptedCreditConversion
                , CumulativeAttemptedCredits
                , CumulativeEarnedCreditConversion
                , CumulativeEarnedCredits
                , CumulativeGradePointAverage
                , CumulativeGradePointsEarned
                , GradeValueQualifier
                , ProjectedGraduationDate
                , SessionAttemptedCreditConversion
                , SessionAttemptedCredits
                , SessionEarnedCreditConversion
                , SessionEarnedCredits
                , SessionGradePointAverage
                , SessionGradePointsEarned
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CumulativeEarnedCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CumulativeAttemptedCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SessionEarnedCreditTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SessionAttemptedCreditTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentAcademicRecordAcademicHonor AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordAcademicHonor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AcademicHonorCategoryDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
            )
            -- Contextual primary key
            AND target.HonorDescription = source.HonorDescription
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AchievementCategorySystem = source.AchievementCategorySystem
            , target.AchievementTitle = source.AchievementTitle
            , target.Criteria = source.Criteria
            , target.CriteriaURL = source.CriteriaURL
            , target.EvidenceStatement = source.EvidenceStatement
            , target.HonorAwardDate = source.HonorAwardDate
            , target.HonorAwardExpiresDate = source.HonorAwardExpiresDate
            , target.ImageURL = source.ImageURL
            , target.IssuerName = source.IssuerName
            , target.IssuerOriginURL = source.IssuerOriginURL
                -- References
            , target.AchievementCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AcademicHonorCategoryDescriptorHashKey
                -- Contextual primary key
                , HonorDescription
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , HonorAwardDate
                , HonorAwardExpiresDate
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                -- References
                , AchievementCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AcademicHonorCategoryDescriptorId)
                )
                -- Contextual primary key
                , HonorDescription
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , HonorAwardDate
                , HonorAwardExpiresDate
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecordClassRanking AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordClassRanking AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ClassRank = source.ClassRank
            , target.ClassRankingDate = source.ClassRankingDate
            , target.PercentageRanking = source.PercentageRanking
            , target.TotalNumberInClass = source.TotalNumberInClass
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Attributes
                , ClassRank
                , ClassRankingDate
                , PercentageRanking
                , TotalNumberInClass
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                -- Attributes
                , ClassRank
                , ClassRankingDate
                , PercentageRanking
                , TotalNumberInClass
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecordDiploma AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordDiploma AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DiplomaTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.DiplomaAwardDate = source.DiplomaAwardDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AchievementCategorySystem = source.AchievementCategorySystem
            , target.AchievementTitle = source.AchievementTitle
            , target.Criteria = source.Criteria
            , target.CriteriaURL = source.CriteriaURL
            , target.CTECompleter = source.CTECompleter
            , target.DiplomaAwardExpiresDate = source.DiplomaAwardExpiresDate
            , target.DiplomaDescription = source.DiplomaDescription
            , target.EvidenceStatement = source.EvidenceStatement
            , target.ImageURL = source.ImageURL
            , target.IssuerName = source.IssuerName
            , target.IssuerOriginURL = source.IssuerOriginURL
                -- References
            , target.AchievementCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
            , target.DiplomaLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DiplomaTypeDescriptorHashKey
                -- Contextual primary key
                , DiplomaAwardDate
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , CTECompleter
                , DiplomaAwardExpiresDate
                , DiplomaDescription
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                -- References
                , AchievementCategoryDescriptorHashKey
                , DiplomaLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaTypeDescriptorId)
                )
                -- Contextual primary key
                , DiplomaAwardDate
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , CTECompleter
                , DiplomaAwardExpiresDate
                , DiplomaDescription
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiplomaLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecordGradePointAverage AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordGradePointAverage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GradePointAverageTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.GradePointAverageValue = source.GradePointAverageValue
            , target.IsCumulative = source.IsCumulative
            , target.MaxGradePointAverageValue = source.MaxGradePointAverageValue
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GradePointAverageTypeDescriptorHashKey
                -- Attributes
                , GradePointAverageValue
                , IsCumulative
                , MaxGradePointAverageValue
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradePointAverageTypeDescriptorId)
                )
                -- Attributes
                , GradePointAverageValue
                , IsCumulative
                , MaxGradePointAverageValue
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecordRecognition AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordRecognition AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.RecognitionTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AchievementCategorySystem = source.AchievementCategorySystem
            , target.AchievementTitle = source.AchievementTitle
            , target.Criteria = source.Criteria
            , target.CriteriaURL = source.CriteriaURL
            , target.EvidenceStatement = source.EvidenceStatement
            , target.ImageURL = source.ImageURL
            , target.IssuerName = source.IssuerName
            , target.IssuerOriginURL = source.IssuerOriginURL
            , target.RecognitionAwardDate = source.RecognitionAwardDate
            , target.RecognitionAwardExpiresDate = source.RecognitionAwardExpiresDate
            , target.RecognitionDescription = source.RecognitionDescription
                -- References
            , target.AchievementCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , RecognitionTypeDescriptorHashKey
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                , RecognitionAwardDate
                , RecognitionAwardExpiresDate
                , RecognitionDescription
                -- References
                , AchievementCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RecognitionTypeDescriptorId)
                )
                -- Attributes
                , AchievementCategorySystem
                , AchievementTitle
                , Criteria
                , CriteriaURL
                , EvidenceStatement
                , ImageURL
                , IssuerName
                , IssuerOriginURL
                , RecognitionAwardDate
                , RecognitionAwardExpiresDate
                , RecognitionDescription
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AchievementCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAcademicRecordReportCard AS target
        USING EdFi_Ods_2021.edfi.StudentAcademicRecordReportCard AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ReportCardHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
            + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ReportCardHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessment AS target
        USING EdFi_Ods_2021.edfi.StudentAssessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AdministrationDate = source.AdministrationDate
            , target.AdministrationEndDate = source.AdministrationEndDate
            , target.EventDescription = source.EventDescription
            , target.SerialNumber = source.SerialNumber
                -- References
            , target.AdministrationEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationEnvironmentDescriptorId)
                )
            , target.EventCircumstanceDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EventCircumstanceDescriptorId)
                )
            , target.WhenAssessedGradeLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenAssessedGradeLevelDescriptorId)
                )
            , target.AdministrationLanguageDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationLanguageDescriptorId)
                )
            , target.PlatformTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
            , target.ReasonNotTestedDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonNotTestedDescriptorId)
                )
            , target.RetestIndicatorDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RetestIndicatorDescriptorId)
                )
            , target.SchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , Namespace
                , StudentAssessmentIdentifier
                , StudentUSI
                -- Identifying references
                , AssessmentHashKey
                , StudentHashKey
                -- Attributes
                , AdministrationDate
                , AdministrationEndDate
                , EventDescription
                , SerialNumber
                -- References
                , AdministrationEnvironmentDescriptorHashKey
                , EventCircumstanceDescriptorHashKey
                , WhenAssessedGradeLevelDescriptorHashKey
                , AdministrationLanguageDescriptorHashKey
                , PlatformTypeDescriptorHashKey
                , ReasonNotTestedDescriptorHashKey
                , RetestIndicatorDescriptorHashKey
                , SchoolYearTypeHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AssessmentIdentifier
                , Namespace
                , StudentAssessmentIdentifier
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.Namespace
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , AdministrationDate
                , AdministrationEndDate
                , EventDescription
                , SerialNumber
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationEnvironmentDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EventCircumstanceDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WhenAssessedGradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AdministrationLanguageDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PlatformTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ReasonNotTestedDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RetestIndicatorDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentAssessmentAccommodation AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentAccommodation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AccommodationDescriptorId)
        + '|' +     source.AssessmentIdentifier
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AccommodationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AccommodationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AccommodationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccommodationDescriptorId)
                + '|' +     source.AssessmentIdentifier
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AccommodationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentItem AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentItem AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentItemHashKey = HASHBYTES('sha1',
                source.AssessmentIdentifier
            + '|' +     source.IdentificationCode
            + '|' +     source.Namespace
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AssessmentResponse = source.AssessmentResponse
            , target.DescriptiveFeedback = source.DescriptiveFeedback
            , target.RawScoreResult = source.RawScoreResult
            , target.TimeAssessed = source.TimeAssessed
                -- References
            , target.AssessmentItemResultDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemResultDescriptorId)
                )
            , target.ResponseIndicatorDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponseIndicatorDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentItemHashKey
                -- Attributes
                , AssessmentResponse
                , DescriptiveFeedback
                , RawScoreResult
                , TimeAssessed
                -- References
                , AssessmentItemResultDescriptorHashKey
                , ResponseIndicatorDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                -- Attributes
                , AssessmentResponse
                , DescriptiveFeedback
                , RawScoreResult
                , TimeAssessed
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentItemResultDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponseIndicatorDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentPerformanceLevel AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentPerformanceLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
            AND target.PerformanceLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PerformanceLevelMet = source.PerformanceLevelMet
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                , PerformanceLevelDescriptorHashKey
                -- Attributes
                , PerformanceLevelMet
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                -- Attributes
                , PerformanceLevelMet
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentScoreResult AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentScoreResult AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.Result = source.Result
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                -- Attributes
                , Result
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Attributes
                , Result
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentStudentObjectiveAssessment AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentStudentObjectiveAssessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ObjectiveAssessmentHashKey = HASHBYTES('sha1',
                source.AssessmentIdentifier
            + '|' +     source.IdentificationCode
            + '|' +     source.Namespace
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ObjectiveAssessmentHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentStudentObjectiveAssessmentPerformanceLevel AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentStudentObjectiveAssessmentPerformanceLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
            AND target.PerformanceLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PerformanceLevelMet = source.PerformanceLevelMet
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                , PerformanceLevelDescriptorHashKey
                -- Attributes
                , PerformanceLevelMet
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PerformanceLevelDescriptorId)
                )
                -- Attributes
                , PerformanceLevelMet
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentAssessmentStudentObjectiveAssessmentScoreResult AS target
        USING EdFi_Ods_2021.edfi.StudentAssessmentStudentObjectiveAssessmentScoreResult AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.AssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
        + '|' +     source.IdentificationCode
        + '|' +     source.Namespace
        + '|' +     source.StudentAssessmentIdentifier
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AssessmentReportingMethodDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.Result = source.Result
                -- References
            , target.ResultDatatypeTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AssessmentReportingMethodDescriptorHashKey
                -- Attributes
                , Result
                -- References
                , ResultDatatypeTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.AssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                + '|' +     source.IdentificationCode
                + '|' +     source.Namespace
                + '|' +     source.StudentAssessmentIdentifier
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AssessmentReportingMethodDescriptorId)
                )
                -- Attributes
                , Result
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResultDatatypeTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCharacteristicDescriptor AS target
        USING EdFi_Ods_2021.edfi.StudentCharacteristicDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StudentCharacteristicDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StudentCharacteristicDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentCohortAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentCohortAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     source.CohortIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , CohortIdentifier
                , EducationOrganizationId
                , StudentUSI
                -- Identifying references
                , CohortHashKey
                , StudentHashKey
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , CohortIdentifier
                , EducationOrganizationId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentCohortAssociationSection AS target
        USING EdFi_Ods_2021.edfi.StudentCohortAssociationSection AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     source.CohortIdentifier
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SectionHashKey = HASHBYTES('sha1',
                source.LocalCourseCode
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            + '|' +     source.SectionIdentifier
            + '|' +     source.SessionName
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SectionHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCompetencyObjective AS target
        USING EdFi_Ods_2021.edfi.StudentCompetencyObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.Objective
        + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DiagnosticStatement = source.DiagnosticStatement
                -- References
            , target.CompetencyLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , Objective
                , ObjectiveEducationOrganizationId
                , ObjectiveGradeLevelDescriptorId
                , StudentUSI
                -- Identifying references
                , ObjectiveCompetencyObjectiveHashKey
                , GradingPeriodHashKey
                , StudentHashKey
                -- Attributes
                , DiagnosticStatement
                -- References
                , CompetencyLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , Objective
                , ObjectiveEducationOrganizationId
                , ObjectiveGradeLevelDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DiagnosticStatement
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentCompetencyObjectiveGeneralStudentProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentCompetencyObjectiveGeneralStudentProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.Objective
        + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GeneralStudentProgramAssociationHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BeginDate, 23)
            + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCompetencyObjectiveStudentSectionAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentCompetencyObjectiveStudentSectionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LocalCourseCode
        + '|' +     source.Objective
        + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentSectionAssociationHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BeginDate, 23)
            + '|' +     source.LocalCourseCode
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            + '|' +     source.SectionIdentifier
            + '|' +     source.SessionName
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentSectionAssociationHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LocalCourseCode
                + '|' +     source.Objective
                + '|' +     CONVERT(nvarchar, source.ObjectiveEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ObjectiveGradeLevelDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCTEProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentCTEProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.NonTraditionalGenderStatus = source.NonTraditionalGenderStatus
            , target.PrivateCTEProgram = source.PrivateCTEProgram
                -- References
            , target.TechnicalSkillsAssessmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TechnicalSkillsAssessmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , NonTraditionalGenderStatus
                , PrivateCTEProgram
                -- References
                , TechnicalSkillsAssessmentDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , NonTraditionalGenderStatus
                , PrivateCTEProgram
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TechnicalSkillsAssessmentDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentCTEProgramAssociationCTEProgram AS target
        USING EdFi_Ods_2021.edfi.StudentCTEProgramAssociationCTEProgram AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.CareerPathwayDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CareerPathwayDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CareerPathwayDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CIPCode = source.CIPCode
            , target.CTEProgramCompletionIndicator = source.CTEProgramCompletionIndicator
            , target.PrimaryCTEProgramIndicator = source.PrimaryCTEProgramIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CareerPathwayDescriptorHashKey
                -- Attributes
                , CIPCode
                , CTEProgramCompletionIndicator
                , PrimaryCTEProgramIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CareerPathwayDescriptorId)
                )
                -- Attributes
                , CIPCode
                , CTEProgramCompletionIndicator
                , PrimaryCTEProgramIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCTEProgramAssociationCTEProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentCTEProgramAssociationCTEProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CTEProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.CIPCode = source.CIPCode
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CTEProgramServiceDescriptorHashKey
                -- Attributes
                , CIPCode
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CTEProgramServiceDescriptorId)
                )
                -- Attributes
                , CIPCode
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentCTEProgramAssociationService AS target
        USING EdFi_Ods_2021.edfi.StudentCTEProgramAssociationService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentDisciplineIncidentAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentDisciplineIncidentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
                -- References
            , target.StudentParticipationCodeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentParticipationCodeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                , StudentUSI
                -- Identifying references
                , DisciplineIncidentHashKey
                , StudentHashKey
                -- References
                , StudentParticipationCodeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , IncidentIdentifier
                , SchoolId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentParticipationCodeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentDisciplineIncidentAssociationBehavior AS target
        USING EdFi_Ods_2021.edfi.StudentDisciplineIncidentAssociationBehavior AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BehaviorDescriptorId)
        + '|' +     source.IncidentIdentifier
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.BehaviorDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BehaviorDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BehaviorDetailedDescription = source.BehaviorDetailedDescription
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , BehaviorDescriptorHashKey
                -- Attributes
                , BehaviorDetailedDescription
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                + '|' +     source.IncidentIdentifier
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BehaviorDescriptorId)
                )
                -- Attributes
                , BehaviorDetailedDescription
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.HispanicLatinoEthnicity = source.HispanicLatinoEthnicity
            , target.LoginId = source.LoginId
            , target.ProfileThumbnail = source.ProfileThumbnail
                -- References
            , target.LimitedEnglishProficiencyDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LimitedEnglishProficiencyDescriptorId)
                )
            , target.OldEthnicityDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
            , target.SexDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , StudentUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , StudentHashKey
                -- Attributes
                , HispanicLatinoEthnicity
                , LoginId
                , ProfileThumbnail
                -- References
                , LimitedEnglishProficiencyDescriptorHashKey
                , OldEthnicityDescriptorHashKey
                , SexDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , HispanicLatinoEthnicity
                , LoginId
                , ProfileThumbnail
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LimitedEnglishProficiencyDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.OldEthnicityDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SexDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentEducationOrganizationAssociationAddress AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
            AND target.StateAbbreviationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
            )
            -- Contextual primary key
            AND target.City = source.City
            AND target.PostalCode = source.PostalCode
            AND target.StreetNumberName = source.StreetNumberName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ApartmentRoomSuiteNumber = source.ApartmentRoomSuiteNumber
            , target.BuildingSiteNumber = source.BuildingSiteNumber
            , target.CongressionalDistrict = source.CongressionalDistrict
            , target.CountyFIPSCode = source.CountyFIPSCode
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
            , target.NameOfCounty = source.NameOfCounty
                -- References
            , target.LocaleDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                , StateAbbreviationDescriptorHashKey
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , LocaleDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                )
                -- Contextual primary key
                , City
                , PostalCode
                , StreetNumberName
                -- Attributes
                , ApartmentRoomSuiteNumber
                , BuildingSiteNumber
                , CongressionalDistrict
                , CountyFIPSCode
                , DoNotPublishIndicator
                , Latitude
                , Longitude
                , NameOfCounty
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LocaleDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationAddressPeriod AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationAddressPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     source.City
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.PostalCode
        + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
        + '|' +     source.StreetNumberName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     source.City
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.PostalCode
                + '|' +     CONVERT(nvarchar, source.StateAbbreviationDescriptorId)
                + '|' +     source.StreetNumberName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationCohortYear AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationCohortYear AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.CohortYearTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
            )
            AND target.SchoolYearTypeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolYear)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , CohortYearTypeDescriptorHashKey
                , SchoolYearTypeHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CohortYearTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationDisability AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationDisability AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisabilityDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisabilityDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisabilityDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DisabilityDiagnosis = source.DisabilityDiagnosis
            , target.OrderOfDisability = source.OrderOfDisability
                -- References
            , target.DisabilityDeterminationSourceTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisabilityDescriptorHashKey
                -- Attributes
                , DisabilityDiagnosis
                , OrderOfDisability
                -- References
                , DisabilityDeterminationSourceTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                )
                -- Attributes
                , DisabilityDiagnosis
                , OrderOfDisability
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationDisabilityDesignation AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationDisabilityDesignation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DisabilityDescriptorId)
        + '|' +     CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisabilityDesignationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisabilityDesignationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                + '|' +     CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationElectronicMail AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationElectronicMail AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ElectronicMailTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.ElectronicMailAddress = source.ElectronicMailAddress
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.PrimaryEmailAddressIndicator = source.PrimaryEmailAddressIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ElectronicMailTypeDescriptorHashKey
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ElectronicMailTypeDescriptorId)
                )
                -- Contextual primary key
                , ElectronicMailAddress
                -- Attributes
                , DoNotPublishIndicator
                , PrimaryEmailAddressIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationInternationalAddress AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationInternationalAddress AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AddressTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AddressTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AddressTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.AddressLine1 = source.AddressLine1
            , target.AddressLine2 = source.AddressLine2
            , target.AddressLine3 = source.AddressLine3
            , target.AddressLine4 = source.AddressLine4
            , target.BeginDate = source.BeginDate
            , target.EndDate = source.EndDate
            , target.Latitude = source.Latitude
            , target.Longitude = source.Longitude
                -- References
            , target.CountryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AddressTypeDescriptorHashKey
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , CountryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AddressTypeDescriptorId)
                )
                -- Attributes
                , AddressLine1
                , AddressLine2
                , AddressLine3
                , AddressLine4
                , BeginDate
                , EndDate
                , Latitude
                , Longitude
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CountryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationLanguage AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationLanguage AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationLanguageUse AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationLanguageUse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
        + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageUseDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageUseDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageUseDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.LanguageDescriptorId)
                + '|' +     CONVERT(nvarchar, source.LanguageUseDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageUseDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationProgramParticipation AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationProgramParticipation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.BeginDate = source.BeginDate
            , target.DesignatedBy = source.DesignatedBy
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramTypeDescriptorHashKey
                -- Attributes
                , BeginDate
                , DesignatedBy
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                -- Attributes
                , BeginDate
                , DesignatedBy
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationProgramParticipationProgramCharacteristic AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationProgramParticipationProgramCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ProgramCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ProgramCharacteristicDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramCharacteristicDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationRace AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationRace AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.RaceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.RaceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.RaceDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , RaceDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.RaceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RaceDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationStudentCharacteristic AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationStudentCharacteristic AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentCharacteristicDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DesignatedBy = source.DesignatedBy
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentCharacteristicDescriptorHashKey
                -- Attributes
                , DesignatedBy
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
                )
                -- Attributes
                , DesignatedBy
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationStudentCharacteristicPeriod AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationStudentCharacteristicPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentCharacteristicDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationStudentIdentificationCode AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationStudentIdentificationCode AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentIdentificationSystemDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
            )
            -- Contextual primary key
            AND target.AssigningOrganizationIdentificationCode = source.AssigningOrganizationIdentificationCode
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.IdentificationCode = source.IdentificationCode
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentIdentificationSystemDescriptorHashKey
                -- Contextual primary key
                , AssigningOrganizationIdentificationCode
                -- Attributes
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
                )
                -- Contextual primary key
                , AssigningOrganizationIdentificationCode
                -- Attributes
                , IdentificationCode
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationStudentIndicator AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationStudentIndicator AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.IndicatorName = source.IndicatorName
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DesignatedBy = source.DesignatedBy
            , target.Indicator = source.Indicator
            , target.IndicatorGroup = source.IndicatorGroup
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , IndicatorName
                -- Attributes
                , DesignatedBy
                , Indicator
                , IndicatorGroup
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , IndicatorName
                -- Attributes
                , DesignatedBy
                , Indicator
                , IndicatorGroup
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationStudentIndicatorPeriod AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationStudentIndicatorPeriod AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.IndicatorName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.BeginDate = source.BeginDate
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.IndicatorName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , BeginDate
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationTelephone AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationTelephone AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TelephoneNumberTypeDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            -- Contextual primary key
            AND target.TelephoneNumber = source.TelephoneNumber
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DoNotPublishIndicator = source.DoNotPublishIndicator
            , target.OrderOfPriority = source.OrderOfPriority
            , target.TextMessageCapabilityIndicator = source.TextMessageCapabilityIndicator
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TelephoneNumberTypeDescriptorHashKey
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                -- Contextual primary key
                , TelephoneNumber
                -- Attributes
                , DoNotPublishIndicator
                , OrderOfPriority
                , TextMessageCapabilityIndicator
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationAssociationTribalAffiliation AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationAssociationTribalAffiliation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TribalAffiliationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TribalAffiliationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentEducationOrganizationResponsibilityAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentEducationOrganizationResponsibilityAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ResponsibilityDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ResponsibilityDescriptorId
                , StudentUSI
                -- Identifying references
                , EducationOrganizationHashKey
                , ResponsibilityDescriptorHashKey
                , StudentHashKey
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ResponsibilityDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ResponsibilityDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResponsibilityDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EndDate
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentGradebookEntry AS target
        USING EdFi_Ods_2021.edfi.StudentGradebookEntry AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.DateAssigned, 23)
        + '|' +     source.GradebookEntryTitle
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DateFulfilled = source.DateFulfilled
            , target.DiagnosticStatement = source.DiagnosticStatement
            , target.LetterGradeEarned = source.LetterGradeEarned
            , target.NumericGradeEarned = source.NumericGradeEarned
                -- References
            , target.CompetencyLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , DateAssigned
                , GradebookEntryTitle
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , GradebookEntryHashKey
                , StudentSectionAssociationHashKey
                -- Attributes
                , DateFulfilled
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , CompetencyLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.DateAssigned, 23)
                + '|' +     source.GradebookEntryTitle
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , DateAssigned
                , GradebookEntryTitle
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DateAssigned, 23)
                + '|' +     source.GradebookEntryTitle
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DateFulfilled
                , DiagnosticStatement
                , LetterGradeEarned
                , NumericGradeEarned
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentHomelessProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentHomelessProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.AwaitingFosterCare = source.AwaitingFosterCare
            , target.HomelessUnaccompaniedYouth = source.HomelessUnaccompaniedYouth
                -- References
            , target.HomelessPrimaryNighttimeResidenceDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessPrimaryNighttimeResidenceDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , AwaitingFosterCare
                , HomelessUnaccompaniedYouth
                -- References
                , HomelessPrimaryNighttimeResidenceDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , AwaitingFosterCare
                , HomelessUnaccompaniedYouth
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessPrimaryNighttimeResidenceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentHomelessProgramAssociationHomelessProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentHomelessProgramAssociationHomelessProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.HomelessProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , HomelessProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.HomelessProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentIdentificationSystemDescriptor AS target
        USING EdFi_Ods_2021.edfi.StudentIdentificationSystemDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StudentIdentificationSystemDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StudentIdentificationSystemDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentIdentificationSystemDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentInterventionAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentInterventionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DiagnosticStatement = source.DiagnosticStatement
            , target.Dosage = source.Dosage
                -- References
            , target.CohortHashKey = HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.CohortEducationOrganizationId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionIdentificationCode
                , StudentUSI
                -- Identifying references
                , InterventionHashKey
                , StudentHashKey
                -- Attributes
                , DiagnosticStatement
                , Dosage
                -- References
                , CohortHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , InterventionIdentificationCode
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DiagnosticStatement
                , Dosage
                -- References
                , HASHBYTES('sha1', 
                    source.CohortIdentifier
                + '|' +     CONVERT(nvarchar, source.CohortEducationOrganizationId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentInterventionAssociationInterventionEffectiveness AS target
        USING EdFi_Ods_2021.edfi.StudentInterventionAssociationInterventionEffectiveness AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.DiagnosisDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DiagnosisDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DiagnosisDescriptorId)
            )
            AND target.GradeLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.GradeLevelDescriptorId)
            )
            AND target.PopulationServedDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.PopulationServedDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.ImprovementIndex = source.ImprovementIndex
                -- References
            , target.InterventionEffectivenessRatingDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DiagnosisDescriptorHashKey
                , GradeLevelDescriptorHashKey
                , PopulationServedDescriptorHashKey
                -- Attributes
                , ImprovementIndex
                -- References
                , InterventionEffectivenessRatingDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradeLevelDescriptorId)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.PopulationServedDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DiagnosisDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.PopulationServedDescriptorId)
                )
                -- Attributes
                , ImprovementIndex
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.InterventionEffectivenessRatingDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentInterventionAttendanceEvent AS target
        USING EdFi_Ods_2021.edfi.StudentInterventionAttendanceEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     source.InterventionIdentificationCode
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AttendanceEventReason = source.AttendanceEventReason
            , target.EventDuration = source.EventDuration
            , target.InterventionDuration = source.InterventionDuration
                -- References
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EducationOrganizationId
                , EventDate
                , InterventionIdentificationCode
                , StudentUSI
                -- Identifying references
                , AttendanceEventCategoryDescriptorHashKey
                , InterventionHashKey
                , StudentHashKey
                -- Attributes
                , AttendanceEventReason
                , EventDuration
                , InterventionDuration
                -- References
                , EducationalEnvironmentDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     source.InterventionIdentificationCode
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EducationOrganizationId
                , EventDate
                , InterventionIdentificationCode
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.InterventionIdentificationCode
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , AttendanceEventReason
                , EventDuration
                , InterventionDuration
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentLanguageInstructionProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentLanguageInstructionProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.Dosage = source.Dosage
            , target.EnglishLearnerParticipation = source.EnglishLearnerParticipation
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , Dosage
                , EnglishLearnerParticipation
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , Dosage
                , EnglishLearnerParticipation
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentLanguageInstructionProgramAssociationEnglishLanguageProficiencyAssessment AS target
        USING EdFi_Ods_2021.edfi.StudentLanguageInstructionProgramAssociationEnglishLanguageProficiencyAssessment AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SchoolYearTypeHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolYear)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
                -- References
            , target.MonitoredDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MonitoredDescriptorId)
                )
            , target.ParticipationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationDescriptorId)
                )
            , target.ProficiencyDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProficiencyDescriptorId)
                )
            , target.ProgressDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SchoolYearTypeHashKey
                -- References
                , MonitoredDescriptorHashKey
                , ParticipationDescriptorHashKey
                , ProficiencyDescriptorHashKey
                , ProgressDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MonitoredDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParticipationDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProficiencyDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgressDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentLanguageInstructionProgramAssociationLanguageInstructionProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentLanguageInstructionProgramAssociationLanguageInstructionProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.LanguageInstructionProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , LanguageInstructionProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.LanguageInstructionProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentLearningObjective AS target
        USING EdFi_Ods_2021.edfi.StudentLearningObjective AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.DiagnosticStatement = source.DiagnosticStatement
                -- References
            , target.CompetencyLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , LearningObjectiveId
                , Namespace
                , StudentUSI
                -- Identifying references
                , GradingPeriodHashKey
                , LearningObjectiveHashKey
                , StudentHashKey
                -- Attributes
                , DiagnosticStatement
                -- References
                , CompetencyLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , GradingPeriodDescriptorId
                , GradingPeriodSchoolId
                , GradingPeriodSchoolYear
                , GradingPeriodSequence
                , LearningObjectiveId
                , Namespace
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                )
                , HASHBYTES('sha1', 
                    source.LearningObjectiveId
                + '|' +     source.Namespace
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DiagnosticStatement
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.CompetencyLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentLearningObjectiveGeneralStudentProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentLearningObjectiveGeneralStudentProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.GeneralStudentProgramAssociationHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BeginDate, 23)
            + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
            + '|' +     source.ProgramName
            + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentLearningObjectiveStudentSectionAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentLearningObjectiveStudentSectionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
        + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
        + '|' +     source.LearningObjectiveId
        + '|' +     source.LocalCourseCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StudentSectionAssociationHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.BeginDate, 23)
            + '|' +     source.LocalCourseCode
            + '|' +     CONVERT(nvarchar, source.SchoolId)
            + '|' +     CONVERT(nvarchar, source.SchoolYear)
            + '|' +     source.SectionIdentifier
            + '|' +     source.SessionName
            + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StudentSectionAssociationHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolId)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSchoolYear)
                + '|' +     CONVERT(nvarchar, source.GradingPeriodSequence)
                + '|' +     source.LearningObjectiveId
                + '|' +     source.LocalCourseCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentMigrantEducationProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentMigrantEducationProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.EligibilityExpirationDate = source.EligibilityExpirationDate
            , target.LastQualifyingMove = source.LastQualifyingMove
            , target.PriorityForServices = source.PriorityForServices
            , target.QualifyingArrivalDate = source.QualifyingArrivalDate
            , target.StateResidencyDate = source.StateResidencyDate
            , target.USInitialEntry = source.USInitialEntry
            , target.USInitialSchoolEntry = source.USInitialSchoolEntry
            , target.USMostRecentEntry = source.USMostRecentEntry
                -- References
            , target.ContinuationOfServicesReasonDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContinuationOfServicesReasonDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , EligibilityExpirationDate
                , LastQualifyingMove
                , PriorityForServices
                , QualifyingArrivalDate
                , StateResidencyDate
                , USInitialEntry
                , USInitialSchoolEntry
                , USMostRecentEntry
                -- References
                , ContinuationOfServicesReasonDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EligibilityExpirationDate
                , LastQualifyingMove
                , PriorityForServices
                , QualifyingArrivalDate
                , StateResidencyDate
                , USInitialEntry
                , USInitialSchoolEntry
                , USMostRecentEntry
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ContinuationOfServicesReasonDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentMigrantEducationProgramAssociationMigrantEducationProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentMigrantEducationProgramAssociationMigrantEducationProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.MigrantEducationProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , MigrantEducationProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MigrantEducationProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentNeglectedOrDelinquentProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentNeglectedOrDelinquentProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.NeglectedOrDelinquentProgramDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramDescriptorId)
                )
            , target.ELAProgressLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ELAProgressLevelDescriptorId)
                )
            , target.MathematicsProgressLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MathematicsProgressLevelDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- References
                , NeglectedOrDelinquentProgramDescriptorHashKey
                , ELAProgressLevelDescriptorHashKey
                , MathematicsProgressLevelDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ELAProgressLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.MathematicsProgressLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentNeglectedOrDelinquentProgramAssociationNeglectedOrDelinquentProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentNeglectedOrDelinquentProgramAssociationNeglectedOrDelinquentProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.NeglectedOrDelinquentProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , NeglectedOrDelinquentProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.NeglectedOrDelinquentProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentParentAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentParentAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.ParentUSI)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ContactPriority = source.ContactPriority
            , target.ContactRestrictions = source.ContactRestrictions
            , target.EmergencyContactStatus = source.EmergencyContactStatus
            , target.LivesWith = source.LivesWith
            , target.PrimaryContactStatus = source.PrimaryContactStatus
                -- References
            , target.RelationDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RelationDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , ParentUSI
                , StudentUSI
                -- Identifying references
                , ParentHashKey
                , StudentHashKey
                -- Attributes
                , ContactPriority
                , ContactRestrictions
                , EmergencyContactStatus
                , LivesWith
                , PrimaryContactStatus
                -- References
                , RelationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , ParentUSI
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , ContactPriority
                , ContactRestrictions
                , EmergencyContactStatus
                , LivesWith
                , PrimaryContactStatus
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RelationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentParticipationCodeDescriptor AS target
        USING EdFi_Ods_2021.edfi.StudentParticipationCodeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.StudentParticipationCodeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , StudentParticipationCodeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentParticipationCodeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , StudentParticipationCodeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentParticipationCodeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentProgramAssociationService AS target
        USING EdFi_Ods_2021.edfi.StudentProgramAssociationService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentProgramAttendanceEvent AS target
        USING EdFi_Ods_2021.edfi.StudentProgramAttendanceEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.AttendanceEventReason = source.AttendanceEventReason
            , target.EventDuration = source.EventDuration
            , target.ProgramAttendanceDuration = source.ProgramAttendanceDuration
                -- References
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EducationOrganizationId
                , EventDate
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , AttendanceEventCategoryDescriptorHashKey
                , EducationOrganizationHashKey
                , ProgramHashKey
                , StudentHashKey
                -- Attributes
                , AttendanceEventReason
                , EventDuration
                , ProgramAttendanceDuration
                -- References
                , EducationalEnvironmentDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EducationOrganizationId
                , EventDate
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , AttendanceEventReason
                , EventDuration
                , ProgramAttendanceDuration
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentSchoolAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EntryDate, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EmployedWhileEnrolled = source.EmployedWhileEnrolled
            , target.ExitWithdrawDate = source.ExitWithdrawDate
            , target.FullTimeEquivalency = source.FullTimeEquivalency
            , target.PrimarySchool = source.PrimarySchool
            , target.RepeatGradeIndicator = source.RepeatGradeIndicator
            , target.SchoolChoiceTransfer = source.SchoolChoiceTransfer
            , target.TermCompletionIndicator = source.TermCompletionIndicator
                -- References
            , target.CalendarHashKey = HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
            , target.EntryGradeLevelReasonDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelReasonDescriptorId)
                )
            , target.EntryTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryTypeDescriptorId)
                )
            , target.ExitWithdrawTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExitWithdrawTypeDescriptorId)
                )
            , target.EntryGradeLevelDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelDescriptorId)
                )
            , target.GraduationPlanHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
            , target.ResidencyStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResidencyStatusDescriptorId)
                )
            , target.SchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
            , target.ClassOfSchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassOfSchoolYear)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EntryDate
                , SchoolId
                , StudentUSI
                -- Identifying references
                , SchoolHashKey
                , StudentHashKey
                -- Attributes
                , EmployedWhileEnrolled
                , ExitWithdrawDate
                , FullTimeEquivalency
                , PrimarySchool
                , RepeatGradeIndicator
                , SchoolChoiceTransfer
                , TermCompletionIndicator
                -- References
                , CalendarHashKey
                , EntryGradeLevelReasonDescriptorHashKey
                , EntryTypeDescriptorHashKey
                , ExitWithdrawTypeDescriptorHashKey
                , EntryGradeLevelDescriptorHashKey
                , GraduationPlanHashKey
                , ResidencyStatusDescriptorHashKey
                , SchoolYearTypeHashKey
                , ClassOfSchoolYearTypeHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryDate, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , EntryDate
                , SchoolId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EmployedWhileEnrolled
                , ExitWithdrawDate
                , FullTimeEquivalency
                , PrimarySchool
                , RepeatGradeIndicator
                , SchoolChoiceTransfer
                , TermCompletionIndicator
                -- References
                , HASHBYTES('sha1', 
                    source.CalendarCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelReasonDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ExitWithdrawTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EntryGradeLevelDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.GraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.GraduationSchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ResidencyStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ClassOfSchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentSchoolAssociationAlternativeGraduationPlan AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolAssociationAlternativeGraduationPlan AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AlternativeEducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.AlternativeGraduationPlanTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.AlternativeGraduationSchoolYear)
        + '|' +     CONVERT(nvarchar, source.EntryDate, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.AlternativeGraduationPlanHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.AlternativeEducationOrganizationId)
            + '|' +     CONVERT(nvarchar, source.AlternativeGraduationPlanTypeDescriptorId)
            + '|' +     CONVERT(nvarchar, source.AlternativeGraduationSchoolYear)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , AlternativeGraduationPlanHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AlternativeEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.AlternativeGraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.AlternativeGraduationSchoolYear)
                + '|' +     CONVERT(nvarchar, source.EntryDate, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AlternativeEducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.AlternativeGraduationPlanTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.AlternativeGraduationSchoolYear)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSchoolAssociationEducationPlan AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolAssociationEducationPlan AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationPlanDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EntryDate, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.EducationPlanDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.EducationPlanDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , EducationPlanDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationPlanDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EntryDate, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationPlanDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSchoolAttendanceEvent AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolAttendanceEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ArrivalTime = source.ArrivalTime
            , target.AttendanceEventReason = source.AttendanceEventReason
            , target.DepartureTime = source.DepartureTime
            , target.EventDuration = source.EventDuration
            , target.SchoolAttendanceDuration = source.SchoolAttendanceDuration
                -- References
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EventDate
                , SchoolId
                , SchoolYear
                , SessionName
                , StudentUSI
                -- Identifying references
                , AttendanceEventCategoryDescriptorHashKey
                , SchoolHashKey
                , SessionHashKey
                , StudentHashKey
                -- Attributes
                , ArrivalTime
                , AttendanceEventReason
                , DepartureTime
                , EventDuration
                , SchoolAttendanceDuration
                -- References
                , EducationalEnvironmentDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EventDate
                , SchoolId
                , SchoolYear
                , SessionName
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , ArrivalTime
                , AttendanceEventReason
                , DepartureTime
                , EventDuration
                , SchoolAttendanceDuration
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentSchoolFoodServiceProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolFoodServiceProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.DirectCertification = source.DirectCertification
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , DirectCertification
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , DirectCertification
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentSchoolFoodServiceProgramAssociationSchoolFoodServiceProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentSchoolFoodServiceProgramAssociationSchoolFoodServiceProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SchoolFoodServiceProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SchoolFoodServiceProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolFoodServiceProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSectionAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentSectionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.EndDate = source.EndDate
            , target.HomeroomIndicator = source.HomeroomIndicator
            , target.TeacherStudentDataLinkExclusion = source.TeacherStudentDataLinkExclusion
                -- References
            , target.AttemptStatusDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptStatusDescriptorId)
                )
            , target.RepeatIdentifierDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RepeatIdentifierDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , SectionHashKey
                , StudentHashKey
                -- Attributes
                , EndDate
                , HomeroomIndicator
                , TeacherStudentDataLinkExclusion
                -- References
                , AttemptStatusDescriptorHashKey
                , RepeatIdentifierDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , EndDate
                , HomeroomIndicator
                , TeacherStudentDataLinkExclusion
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttemptStatusDescriptorId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.RepeatIdentifierDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentSectionAttendanceEvent AS target
        USING EdFi_Ods_2021.edfi.StudentSectionAttendanceEvent AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EventDate, 23)
        + '|' +     source.LocalCourseCode
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ArrivalTime = source.ArrivalTime
            , target.AttendanceEventReason = source.AttendanceEventReason
            , target.DepartureTime = source.DepartureTime
            , target.EventDuration = source.EventDuration
            , target.SectionAttendanceDuration = source.SectionAttendanceDuration
                -- References
            , target.EducationalEnvironmentDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EventDate
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , AttendanceEventCategoryDescriptorHashKey
                , SectionHashKey
                , StudentHashKey
                -- Attributes
                , ArrivalTime
                , AttendanceEventReason
                , DepartureTime
                , EventDuration
                , SectionAttendanceDuration
                -- References
                , EducationalEnvironmentDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EventDate, 23)
                + '|' +     source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , AttendanceEventCategoryDescriptorId
                , EventDate
                , LocalCourseCode
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.AttendanceEventCategoryDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , ArrivalTime
                , AttendanceEventReason
                , DepartureTime
                , EventDuration
                , SectionAttendanceDuration
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationalEnvironmentDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.StudentSpecialEducationProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Attributes
            target.IdeaEligibility = source.IdeaEligibility
            , target.IEPBeginDate = source.IEPBeginDate
            , target.IEPEndDate = source.IEPEndDate
            , target.IEPReviewDate = source.IEPReviewDate
            , target.LastEvaluationDate = source.LastEvaluationDate
            , target.MedicallyFragile = source.MedicallyFragile
            , target.MultiplyDisabled = source.MultiplyDisabled
            , target.SchoolHoursPerWeek = source.SchoolHoursPerWeek
            , target.SpecialEducationHoursPerWeek = source.SpecialEducationHoursPerWeek
                -- References
            , target.SpecialEducationSettingDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationSettingDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- Attributes
                , IdeaEligibility
                , IEPBeginDate
                , IEPEndDate
                , IEPReviewDate
                , LastEvaluationDate
                , MedicallyFragile
                , MultiplyDisabled
                , SchoolHoursPerWeek
                , SpecialEducationHoursPerWeek
                -- References
                , SpecialEducationSettingDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- Attributes
                , IdeaEligibility
                , IEPBeginDate
                , IEPEndDate
                , IEPReviewDate
                , LastEvaluationDate
                , MedicallyFragile
                , MultiplyDisabled
                , SchoolHoursPerWeek
                , SpecialEducationHoursPerWeek
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationSettingDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentSpecialEducationProgramAssociationDisability AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociationDisability AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.DisabilityDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisabilityDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisabilityDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.DisabilityDiagnosis = source.DisabilityDiagnosis
            , target.OrderOfDisability = source.OrderOfDisability
                -- References
            , target.DisabilityDeterminationSourceTypeDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisabilityDescriptorHashKey
                -- Attributes
                , DisabilityDiagnosis
                , OrderOfDisability
                -- References
                , DisabilityDeterminationSourceTypeDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.DisabilityDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDescriptorId)
                )
                -- Attributes
                , DisabilityDiagnosis
                , OrderOfDisability
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDeterminationSourceTypeDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSpecialEducationProgramAssociationDisabilityDesignation AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociationDisabilityDesignation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.DisabilityDescriptorId)
        + '|' +     CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.DisabilityDesignationDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , DisabilityDesignationDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.DisabilityDescriptorId)
                + '|' +     CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.DisabilityDesignationDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSpecialEducationProgramAssociationServiceProvider AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociationServiceProvider AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StaffHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StaffUSI)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryProvider = source.PrimaryProvider
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StaffHashKey
                -- Attributes
                , PrimaryProvider
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , PrimaryProvider
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSpecialEducationProgramAssociationSpecialEducationProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociationSpecialEducationProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SpecialEducationProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SpecialEducationProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentSpecialEducationProgramAssociationSpecialEducationProgramServiceProvider AS target
        USING EdFi_Ods_2021.edfi.StudentSpecialEducationProgramAssociationSpecialEducationProgramServiceProvider AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.StaffHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.StaffUSI)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryProvider = source.PrimaryProvider
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , StaffHashKey
                -- Attributes
                , PrimaryProvider
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.SpecialEducationProgramServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                -- Attributes
                , PrimaryProvider
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentTitleIPartAProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.StudentTitleIPartAProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
                -- References
            target.TitleIPartAParticipantDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAParticipantDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , GeneralStudentProgramAssociationHashKey
                -- References
                , TitleIPartAParticipantDescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Primary key columns
                , BeginDate
                , EducationOrganizationId
                , ProgramEducationOrganizationId
                , ProgramName
                , ProgramTypeDescriptorId
                , StudentUSI
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAParticipantDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.StudentTitleIPartAProgramAssociationService AS target
        USING EdFi_Ods_2021.edfi.StudentTitleIPartAProgramAssociationService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.ServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.ServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , ServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.ServiceDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.StudentTitleIPartAProgramAssociationTitleIPartAProgramService AS target
        USING EdFi_Ods_2021.edfi.StudentTitleIPartAProgramAssociationTitleIPartAProgramService AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.BeginDate, 23)
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     CONVERT(nvarchar, source.StudentUSI)
        + '|' +     CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.TitleIPartAProgramServiceDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
            )
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.PrimaryIndicator = source.PrimaryIndicator
            , target.ServiceBeginDate = source.ServiceBeginDate
            , target.ServiceEndDate = source.ServiceEndDate
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , TitleIPartAProgramServiceDescriptorHashKey
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.BeginDate, 23)
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     CONVERT(nvarchar, source.ProgramEducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     CONVERT(nvarchar, source.StudentUSI)
                + '|' +     CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
                )
                -- Attributes
                , PrimaryIndicator
                , ServiceBeginDate
                , ServiceEndDate
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.Survey AS target
        USING EdFi_Ods_2021.edfi.Survey AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.NumberAdministered = source.NumberAdministered
            , target.SurveyTitle = source.SurveyTitle
                -- References
            , target.EducationOrganizationHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
            , target.SchoolYearTypeHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
            , target.SessionHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
            , target.SurveyCategoryDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyCategoryDescriptorId)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                -- Identifying references
                -- Attributes
                , NumberAdministered
                , SurveyTitle
                -- References
                , EducationOrganizationHashKey
                , SchoolYearTypeHashKey
                , SessionHashKey
                , SurveyCategoryDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                -- Identifying references
                -- Attributes
                , NumberAdministered
                , SurveyTitle
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolYear)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyCategoryDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyCategoryDescriptor AS target
        USING EdFi_Ods_2021.edfi.SurveyCategoryDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SurveyCategoryDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SurveyCategoryDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyCategoryDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SurveyCategoryDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyCategoryDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SurveyCourseAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveyCourseAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.CourseCode
        + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Namespace
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , CourseCode
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                -- Identifying references
                , CourseHashKey
                , SurveyHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , CourseCode
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.CourseCode
                + '|' +     CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyLevelDescriptor AS target
        USING EdFi_Ods_2021.edfi.SurveyLevelDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.SurveyLevelDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , SurveyLevelDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyLevelDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , SurveyLevelDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyLevelDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.SurveyProgramAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveyProgramAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Namespace
        + '|' +     source.ProgramName
        + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , ProgramName
                , ProgramTypeDescriptorId
                , SurveyIdentifier
                -- Identifying references
                , ProgramHashKey
                , SurveyHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Namespace
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , ProgramName
                , ProgramTypeDescriptorId
                , SurveyIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.ProgramName
                + '|' +     CONVERT(nvarchar, source.ProgramTypeDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyQuestion AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestion AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.QuestionText = source.QuestionText
                -- References
            , target.QuestionFormDescriptorHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.QuestionFormDescriptorId)
                )
            , target.SurveySectionHashKey = HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveySectionTitle
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , QuestionCode
                , SurveyIdentifier
                -- Identifying references
                , SurveyHashKey
                -- Attributes
                , QuestionText
                -- References
                , QuestionFormDescriptorHashKey
                , SurveySectionHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , QuestionCode
                , SurveyIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Attributes
                , QuestionText
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.QuestionFormDescriptorId)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveySectionTitle
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyQuestionMatrix AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestionMatrix AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.MatrixElement = source.MatrixElement
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaxRawScore = source.MaxRawScore
            , target.MinRawScore = source.MinRawScore
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , MatrixElement
                -- Attributes
                , MaxRawScore
                , MinRawScore
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , MatrixElement
                -- Attributes
                , MaxRawScore
                , MinRawScore
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SurveyQuestionResponseChoice AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestionResponseChoice AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.SortOrder = source.SortOrder
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.NumericValue = source.NumericValue
            , target.TextValue = source.TextValue
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , SortOrder
                -- Attributes
                , NumericValue
                , TextValue
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , SortOrder
                -- Attributes
                , NumericValue
                , TextValue
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SurveyQuestionResponse AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestionResponse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.Comment = source.Comment
            , target.NoResponse = source.NoResponse
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , QuestionCode
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , SurveyQuestionHashKey
                , SurveyResponseHashKey
                -- Attributes
                , Comment
                , NoResponse
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , QuestionCode
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                -- Attributes
                , Comment
                , NoResponse
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyQuestionResponseSurveyQuestionMatrixElementResponse AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestionResponseSurveyQuestionMatrixElementResponse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.MatrixElement = source.MatrixElement
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.MaxNumericResponse = source.MaxNumericResponse
            , target.MinNumericResponse = source.MinNumericResponse
            , target.NoResponse = source.NoResponse
            , target.NumericResponse = source.NumericResponse
            , target.TextResponse = source.TextResponse
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , MatrixElement
                -- Attributes
                , MaxNumericResponse
                , MinNumericResponse
                , NoResponse
                , NumericResponse
                , TextResponse
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , MatrixElement
                -- Attributes
                , MaxNumericResponse
                , MinNumericResponse
                , NoResponse
                , NumericResponse
                , TextResponse
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SurveyQuestionResponseValue AS target
        USING EdFi_Ods_2021.edfi.SurveyQuestionResponseValue AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.QuestionCode
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            -- Contextual primary key
            AND target.SurveyQuestionResponseValueIdentifier = source.SurveyQuestionResponseValueIdentifier
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            -- Attributes
            , target.NumericResponse = source.NumericResponse
            , target.TextResponse = source.TextResponse
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                -- Contextual primary key
                , SurveyQuestionResponseValueIdentifier
                -- Attributes
                , NumericResponse
                , TextResponse
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.QuestionCode
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                -- Contextual primary key
                , SurveyQuestionResponseValueIdentifier
                -- Attributes
                , NumericResponse
                , TextResponse
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SurveyResponse AS target
        USING EdFi_Ods_2021.edfi.SurveyResponse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.ElectronicMailAddress = source.ElectronicMailAddress
            , target.FullName = source.FullName
            , target.Location = source.Location
            , target.ResponseDate = source.ResponseDate
            , target.ResponseTime = source.ResponseTime
                -- References
            , target.ParentHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                )
            , target.StaffHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
            , target.StudentHashKey = HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , SurveyHashKey
                -- Attributes
                , ElectronicMailAddress
                , FullName
                , Location
                , ResponseDate
                , ResponseTime
                -- References
                , ParentHashKey
                , StaffHashKey
                , StudentHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Attributes
                , ElectronicMailAddress
                , FullName
                , Location
                , ResponseDate
                , ResponseTime
                -- References
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.ParentUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StudentUSI)
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyResponseSurveyLevel AS target
        USING EdFi_Ods_2021.edfi.SurveyResponseSurveyLevel AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     CONVERT(nvarchar, source.SurveyLevelDescriptorId)
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
            -- Identifying references
            AND target.SurveyLevelDescriptorHashKey = HASHBYTES('sha1',
                CONVERT(nvarchar, source.SurveyLevelDescriptorId)
            )
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Identifying references
                , SurveyLevelDescriptorHashKey
                -- Boilerplate columns
                , CreateDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     CONVERT(nvarchar, source.SurveyLevelDescriptorId)
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.SurveyLevelDescriptorId)
                )
                -- Boilerplate columns
                , CreateDate
            );
        MERGE edfi.SurveyResponseEducationOrganizationTargetAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveyResponseEducationOrganizationTargetAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , EducationOrganizationHashKey
                , SurveyResponseHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveyResponseStaffTargetAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveyResponseStaffTargetAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , StaffUSI
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , StaffHashKey
                , SurveyResponseHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , StaffUSI
                , SurveyIdentifier
                , SurveyResponseIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveySection AS target
        USING EdFi_Ods_2021.edfi.SurveySection AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveySectionTitle
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveySectionTitle
                -- Identifying references
                , SurveyHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveySectionTitle
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveySectionTitle
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveySectionAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveySectionAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.LocalCourseCode
        + '|' +     source.Namespace
        + '|' +     CONVERT(nvarchar, source.SchoolId)
        + '|' +     CONVERT(nvarchar, source.SchoolYear)
        + '|' +     source.SectionIdentifier
        + '|' +     source.SessionName
        + '|' +     source.SurveyIdentifier
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , Namespace
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , SurveyIdentifier
                -- Identifying references
                , SectionHashKey
                , SurveyHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     source.Namespace
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                + '|' +     source.SurveyIdentifier
                )
                , @schoolYearContext
                -- Primary key columns
                , LocalCourseCode
                , Namespace
                , SchoolId
                , SchoolYear
                , SectionIdentifier
                , SessionName
                , SurveyIdentifier
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.LocalCourseCode
                + '|' +     CONVERT(nvarchar, source.SchoolId)
                + '|' +     CONVERT(nvarchar, source.SchoolYear)
                + '|' +     source.SectionIdentifier
                + '|' +     source.SessionName
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveySectionResponse AS target
        USING EdFi_Ods_2021.edfi.SurveySectionResponse AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
        + '|' +     source.SurveySectionTitle
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN MATCHED THEN
            UPDATE SET
            -- Boilerplate columns
            CreateDate = source.CreateDate
            , Id = source.Id
            , LastModifiedDate = source.LastModifiedDate
            -- Attributes
            , target.SectionRating = source.SectionRating
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , SurveyResponseHashKey
                , SurveySectionHashKey
                -- Attributes
                , SectionRating
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                + '|' +     source.SurveySectionTitle
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveySectionTitle
                )
                -- Attributes
                , SectionRating
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveySectionResponseEducationOrganizationTargetAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveySectionResponseEducationOrganizationTargetAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.EducationOrganizationId)
        + '|' +     source.Namespace
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
        + '|' +     source.SurveySectionTitle
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , EducationOrganizationHashKey
                , SurveySectionResponseHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                + '|' +     source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                + '|' +     source.SurveySectionTitle
                )
                , @schoolYearContext
                -- Primary key columns
                , EducationOrganizationId
                , Namespace
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.EducationOrganizationId)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                + '|' +     source.SurveySectionTitle
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.SurveySectionResponseStaffTargetAssociation AS target
        USING EdFi_Ods_2021.edfi.SurveySectionResponseStaffTargetAssociation AS source
        ON (target.HashKey = HASHBYTES('sha1',
            source.Namespace
        + '|' +     CONVERT(nvarchar, source.StaffUSI)
        + '|' +     source.SurveyIdentifier
        + '|' +     source.SurveyResponseIdentifier
        + '|' +     source.SurveySectionTitle
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , Namespace
                , StaffUSI
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , StaffHashKey
                , SurveySectionResponseHashKey
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            )
            VALUES (
                HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     CONVERT(nvarchar, source.StaffUSI)
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                + '|' +     source.SurveySectionTitle
                )
                , @schoolYearContext
                -- Primary key columns
                , Namespace
                , StaffUSI
                , SurveyIdentifier
                , SurveyResponseIdentifier
                , SurveySectionTitle
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.StaffUSI)
                )
                , HASHBYTES('sha1', 
                    source.Namespace
                + '|' +     source.SurveyIdentifier
                + '|' +     source.SurveyResponseIdentifier
                + '|' +     source.SurveySectionTitle
                )
                -- Boilerplate columns
                , CreateDate
                , Id
                , LastModifiedDate
            );
    
        MERGE edfi.TeachingCredentialBasisDescriptor AS target
        USING EdFi_Ods_2021.edfi.TeachingCredentialBasisDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TeachingCredentialBasisDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TeachingCredentialBasisDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialBasisDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TeachingCredentialBasisDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialBasisDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TeachingCredentialDescriptor AS target
        USING EdFi_Ods_2021.edfi.TeachingCredentialDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TeachingCredentialDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TeachingCredentialDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TeachingCredentialDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TeachingCredentialDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TechnicalSkillsAssessmentDescriptor AS target
        USING EdFi_Ods_2021.edfi.TechnicalSkillsAssessmentDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TechnicalSkillsAssessmentDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TechnicalSkillsAssessmentDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TechnicalSkillsAssessmentDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TechnicalSkillsAssessmentDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TechnicalSkillsAssessmentDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TelephoneNumberTypeDescriptor AS target
        USING EdFi_Ods_2021.edfi.TelephoneNumberTypeDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TelephoneNumberTypeDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TelephoneNumberTypeDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TelephoneNumberTypeDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TermDescriptor AS target
        USING EdFi_Ods_2021.edfi.TermDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TermDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TermDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TermDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TermDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TermDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TitleIPartAParticipantDescriptor AS target
        USING EdFi_Ods_2021.edfi.TitleIPartAParticipantDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TitleIPartAParticipantDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TitleIPartAParticipantDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAParticipantDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TitleIPartAParticipantDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAParticipantDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TitleIPartAProgramServiceDescriptor AS target
        USING EdFi_Ods_2021.edfi.TitleIPartAProgramServiceDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TitleIPartAProgramServiceDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TitleIPartAProgramServiceDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartAProgramServiceDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TitleIPartASchoolDesignationDescriptor AS target
        USING EdFi_Ods_2021.edfi.TitleIPartASchoolDesignationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TitleIPartASchoolDesignationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TitleIPartASchoolDesignationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartASchoolDesignationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TitleIPartASchoolDesignationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TitleIPartASchoolDesignationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.TribalAffiliationDescriptor AS target
        USING EdFi_Ods_2021.edfi.TribalAffiliationDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , TribalAffiliationDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , TribalAffiliationDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.TribalAffiliationDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.VisaDescriptor AS target
        USING EdFi_Ods_2021.edfi.VisaDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.VisaDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , VisaDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.VisaDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , VisaDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.VisaDescriptorId)
                )
                -- Boilerplate columns
            );
    
        MERGE edfi.WeaponDescriptor AS target
        USING EdFi_Ods_2021.edfi.WeaponDescriptor AS source
        ON (target.HashKey = HASHBYTES('sha1',
            CONVERT(nvarchar, source.WeaponDescriptorId)
            )
            AND target.SchoolYearContext = @schoolYearContext
        )
        WHEN NOT MATCHED THEN
            INSERT (
                HashKey
                , SchoolYearContext
                -- Primary key columns
                , WeaponDescriptorId
                -- Identifying references
                , DescriptorHashKey
                -- Boilerplate columns
            )
            VALUES (
                HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WeaponDescriptorId)
                )
                , @schoolYearContext
                -- Primary key columns
                , WeaponDescriptorId
                -- Identifying references
                , HASHBYTES('sha1', 
                    CONVERT(nvarchar, source.WeaponDescriptorId)
                )
                -- Boilerplate columns
            );
    
    -- enable all constraints
    EXEC sp_MSforeachtable @command1="print '?'", @command2="ALTER TABLE ? WITH CHECK CHECK CONSTRAINT all"
END