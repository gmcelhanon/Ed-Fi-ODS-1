-- Foreign key from entity identity table
ALTER TABLE {{Schema}}.{{TableName}}_Attributes WITH CHECK ADD CONSTRAINT FK_{{TableName}}_Attributes FOREIGN KEY
{{#IsAggregateRoot}}
(HashKey) REFERENCES {{Schema}}.{{TableName}} (HashKey)
{{/IsAggregateRoot}}
{{^IsAggregateRoot}}
(HashKey{{#IdentifyingReferences}}{{#Column}}, {{ColumnName}}{{/Column}}{{/IdentifyingReferences}}{{#ContextualPrimaryKeyColumns}}, {{ColumnName}}{{/ContextualPrimaryKeyColumns}}) REFERENCES {{Schema}}.{{TableName}} (HashKey{{#IdentifyingReferences}}{{#Column}}, {{ColumnName}}{{/Column}}{{/IdentifyingReferences}}{{#ContextualPrimaryKeyColumns}}, {{ColumnName}}{{/ContextualPrimaryKeyColumns}})
{{/IsAggregateRoot}}
GO
